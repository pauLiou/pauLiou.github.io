---
jupyter:
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
  language_info:
    codemirror_mode:
      name: ipython
      version: 3
    file_extension: .py
    mimetype: text/x-python
    name: python
    nbconvert_exporter: python
    pygments_lexer: ipython3
    version: 3.7.12
  nbformat: 4
  nbformat_minor: 5
  papermill:
    default_parameters: {}
    duration: 415.406989
    end_time: "2022-10-13T14:25:50.001900"
    environment_variables: {}
    input_path: \_\_notebook\_\_.ipynb
    output_path: \_\_notebook\_\_.ipynb
    parameters: {}
    start_time: "2022-10-13T14:18:54.594911"
    version: 2.3.4
  widgets:
    application/vnd.jupyter.widget-state+json:
      state:
        008c84e25ac144b6a379f9a61a848390:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        00fe60ece15745efad8a7d91f252023f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_2b439e17b2504f0b831e4d893b0eb307
            max: 5
            min: 0
            orientation: horizontal
            style: IPY_MODEL_5d9f5cb78c554f8b8c3188a6ebfd941c
            value: 5
        01338ac57ce1452a8f1fb618c5b01118:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_6c1dc803d4fe40ceb2c0c2d931670d6a
            placeholder: ​
            style: IPY_MODEL_7329444f88384c5689c148eb4e333a2e
            value: " 5/5 \\[00:00&lt;00:00, 16.34it/s\\]"
        018c5ee3c82f48ab84bf7a63a80a3c8d:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        0352b219e6be4a84812628abc1d1d8d8:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_fee276819fd5452ba48a8eab13badb1c
            - IPY_MODEL_a636cf2d1fc540efbcba8f04dfe77e43
            - IPY_MODEL_8097588cf530476889d60e0cbd0a379b
            layout: IPY_MODEL_2e801df831d84688a2dac05836b15239
        06b9725bcd5844539bf28f735e65efb4:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_81480510680a40568d05a7bf4d3752bb
            - IPY_MODEL_3d56413808fb498fb22e18c0b2ff0181
            - IPY_MODEL_b5ee5c7dcf16425bbb9db085e98dcf59
            layout: IPY_MODEL_92888c0aeef94bfb9d5cb9329f0a1c2e
        06efaf8e30a44e8fb043e3ca0c1a82ad:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        07b86262379047938d204ea7a0e8be30:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        07b87e2a9c414b6389b0e7662a2c791f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_7bf6af490df94601904c70bd76ef64cf
            - IPY_MODEL_53b51b1dc6334b4bbc47f9501a4d8a39
            - IPY_MODEL_b6f5e8b6cf5a48dab12a522434945e00
            layout: IPY_MODEL_9dcbee831daa47ce8c61b64d46e09a7a
        087070c4b4ad443d8a92404566f83d64:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        09d869bf817042d2a5e312af8be63f69:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        0a075b9e596a4cf896e8381136afd392:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_5275983a49a14ae88f8cc813f833444b
            placeholder: ​
            style: IPY_MODEL_1bed398762934e9499df8c84b615b369
            value: 100%
        0d5158380a8b41508dcc73dcd1792577:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        0e106349935a41e09d1a37160d23d603:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        0e26fc65a9854dc9a3b7f7e1760ec30e:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_b906ceb2b7c8453681df7972f90a6ef4
            max: 12
            min: 0
            orientation: horizontal
            style: IPY_MODEL_9e0e75ad889f40f78d4e3d072de18109
            value: 12
        0f21a08f5c7f424baabf545432b43b38:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_b527117cb876485cbd61589f79694c37
            placeholder: ​
            style: IPY_MODEL_c69df1206bec4c71a353a4bd54a6064c
            value: " 5/5 \\[00:00&lt;00:00, 15.96it/s\\]"
        10266a64e00b4d1c88aba40dc6467232:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        11032fd7cff446c9b17a23e8fc9ac620:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        11cf0333130a4eed964e9cc84929ae1f:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        139680617a224bf68e9693d340fd844b:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_e4175a8b9ed04077a051898031de86d6
            placeholder: ​
            style: IPY_MODEL_bd44bdd089ce465aa804cc0a887ac2bc
            value: " 12/12 \\[00:00&lt;00:00, 16.37it/s\\]"
        14befd37e6864371893bc425249e04d3:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_7d81e4e1926e421fbeccbfcd8d4c0f9d
            - IPY_MODEL_0e26fc65a9854dc9a3b7f7e1760ec30e
            - IPY_MODEL_197dc8bff9804026afb8660f878c9020
            layout: IPY_MODEL_a6d428c2bb204516b35352176a57cedb
        1686300c4411485db10de791dfd7c01a:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        16c686fe8f5245cebe4c37a969fa9b01:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_e1a6c6892b0545d587da52060da0a030
            placeholder: ​
            style: IPY_MODEL_f388dfa2b8944cf4803927769d19a9e7
            value: 100%
        17d5463f266243c7823d0c0840118cf0:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        17febd8838794980a96751b661c6de54:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_f917f525d2dc4b3c8bc7fc683396d5e7
            placeholder: ​
            style: IPY_MODEL_9611a9dd3ba94092b959a57f03e03dd5
            value: 100%
        1831a88c0c35415fa61c728c78cd3cda:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        1912b11ac0f14ad5bc4c79a2178cb787:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        197dc8bff9804026afb8660f878c9020:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_a38905fa0de64e2e8225736b0819ca99
            placeholder: ​
            style: IPY_MODEL_be96f921fd044261a1c9eee076b6972c
            value: " 12/12 \\[00:00&lt;00:00, 16.65it/s\\]"
        1bed398762934e9499df8c84b615b369:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        1d0048d0f19441d893477af4f2137d6d:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        1e2563f5b39e49ab9e9fc254b8c68f23:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_81e3cfc65ace434280c076cea242c0a2
            placeholder: ​
            style: IPY_MODEL_bd10a0ba2dbb44259dffea066d1e5e80
            value: 100%
        1e3a659ce431411eb3cb9ee232006010:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        20cce9b7c3e14e70a095d47382d8ba5d:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        22a6439fff9a4a508158de1079343ce5:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        2334b3b4b7594934aa3bf3f576d08e40:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_17febd8838794980a96751b661c6de54
            - IPY_MODEL_00fe60ece15745efad8a7d91f252023f
            - IPY_MODEL_d6b63c9828c146a4a11cff5c400166ac
            layout: IPY_MODEL_9e2938f632de4cab8dfb8c86c68ba2e7
        26494a3eaf884ecd86450956533d94a4:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        26c8ff9d6b914798b89098849eeed189:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        27c57e87a5a94fbfa0901e32f6673e3d:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        296ccbc1f7474cba91b08b4ad2c3b41f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        2a3db87259734ca7bc08ebadbb7e2313:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        2a47589ca3054d4e9ca8cdfec43bacfc:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_1912b11ac0f14ad5bc4c79a2178cb787
            placeholder: ​
            style: IPY_MODEL_1831a88c0c35415fa61c728c78cd3cda
            value: 100%
        2b439e17b2504f0b831e4d893b0eb307:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        2b5fe2ac6d8b458dace0f04886e0a31a:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        2d294d15bff9432eb1b4c9aedbee6555:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        2d822f13201c48e1bae1757759a0e578:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        2dade71916784e0e9ffe69083edce128:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_1686300c4411485db10de791dfd7c01a
            max: 12
            min: 0
            orientation: horizontal
            style: IPY_MODEL_81e69a8cad314284b52d605d6adddb64
            value: 12
        2dddaff64d334046945ccba5a506864c:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        2e701e3c8ea14d5083e75414c53c9b4f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_8677aff8d8d8482bb5e4ae0be05018c9
            - IPY_MODEL_4af839d52a674b3cac466fc2359b30c0
            - IPY_MODEL_68cfaaaae5fe4a0880cfe2c2db930724
            layout: IPY_MODEL_a83d7dda6af14dfea724ebe20c622c07
        2e801df831d84688a2dac05836b15239:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        34aee39fccf5435da2e790f5af947d74:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        34d5e9cdadd44eceb0c9b0d32c2ab1ea:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        3525fa1b84da4080828f5248d925c1d2:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_ca2fc170ab6f4a71b9b4972fe249c6d0
            - IPY_MODEL_bc252749f0784bb7a15d1a4b0686e1c7
            - IPY_MODEL_d668986e40d14953926809ef93357034
            layout: IPY_MODEL_22a6439fff9a4a508158de1079343ce5
        356ad9c9a31046d588fc6642f99d2ded:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        360835624ce64ece896d2dacd5ef9391:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        3949b430b0f54b869c9bf63331217367:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        3d56413808fb498fb22e18c0b2ff0181:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_69161c1520f84facbb0bf373e56309ae
            max: 5
            min: 0
            orientation: horizontal
            style: IPY_MODEL_7c775522d6df4de2bbadfc7e52d177ef
            value: 5
        3de683c3b97e4e9b8a0d74aa7e452334:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        3fb0214dc4c744aebd62cd1720cd95bb:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        40576a5dbf8b4c3f9487f2717b61cc9f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_1e2563f5b39e49ab9e9fc254b8c68f23
            - IPY_MODEL_729aa6f69a744dcebe635e65917348df
            - IPY_MODEL_139680617a224bf68e9693d340fd844b
            layout: IPY_MODEL_55f5eff87cc24580bad3b31847176efb
        499b122d4c0544ba92f98eae610f615f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_fd643449dd984b5ba37febcb7c1e8c81
            placeholder: ​
            style: IPY_MODEL_c90560fd3545425b81149f18faef50c9
            value: 100%
        4af839d52a674b3cac466fc2359b30c0:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_e3983ec8ac9d4b7f94a253ac2c1ff680
            max: 12
            min: 0
            orientation: horizontal
            style: IPY_MODEL_1e3a659ce431411eb3cb9ee232006010
            value: 12
        4bb9af3e5157436c94905c4ba7b77c3e:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_7ce3181ee78a445f9238983951948784
            max: 12
            min: 0
            orientation: horizontal
            style: IPY_MODEL_9cdbc41fe9274de1948dc188daa24f98
            value: 12
        4f1141211bc1480b865bc10630231f2e:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_f439cb97e77f4bdab3a15d81b81181e8
            max: 12
            min: 0
            orientation: horizontal
            style: IPY_MODEL_98d28a6057044d0db96555945fe3debf
            value: 12
        505914312e8444e8841cf3e10232fed9:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        5275983a49a14ae88f8cc813f833444b:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        52b93245e1fe40159b09cc452962b4c2:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_0a075b9e596a4cf896e8381136afd392
            - IPY_MODEL_b8663f73014f471bb324531dad3818c9
            - IPY_MODEL_b42b0cfb1d56424c8ab9947e490ba1bd
            layout: IPY_MODEL_a545aca8631f42b694713344cb97e74c
        53b51b1dc6334b4bbc47f9501a4d8a39:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_fe7120f4bb6b4eda963a5d3d0e61da80
            max: 5
            min: 0
            orientation: horizontal
            style: IPY_MODEL_2d822f13201c48e1bae1757759a0e578
            value: 5
        559f4a9b82984ea794793813d19f9479:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        55f5eff87cc24580bad3b31847176efb:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        58191943215d4e20a3e5bab52c78159b:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        58cea40f0aeb4447ba97a734b3104a17:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_b27300bfc9124bca88e9df2f2931899a
            placeholder: ​
            style: IPY_MODEL_d40c034e37c748b7bfcb350975089bed
            value: " 5/5 \\[00:00&lt;00:00, 15.65it/s\\]"
        5d9f5cb78c554f8b8c3188a6ebfd941c:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        617b15ca8e37404580b3d082fdb3da91:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        61c769d30826410aa9109033bc52c930:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        64142db73ea94c1f9cc8a6d003ae4453:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_d1a09e7bd43a41b794d93f9adc12b40a
            placeholder: ​
            style: IPY_MODEL_360835624ce64ece896d2dacd5ef9391
            value: 100%
        68cfaaaae5fe4a0880cfe2c2db930724:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_a4c414ea90fd4ee99322e35746e63151
            placeholder: ​
            style: IPY_MODEL_d0768e0e13cc40ae9263aca68d071a86
            value: " 12/12 \\[00:00&lt;00:00, 16.89it/s\\]"
        68f719d6cbfd4cbe9f473c25e0ff49e3:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        69161c1520f84facbb0bf373e56309ae:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        696c965ee99c48cd9fa2c76479a52ad5:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        699f1d9ee1f54e67bd1c986e98796f64:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        6c1dc803d4fe40ceb2c0c2d931670d6a:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        6c2d3e30a3ac44b59970cf7b101ba5ea:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_8acd8eebdaf34fac989baaa11bf3ac96
            max: 5
            min: 0
            orientation: horizontal
            style: IPY_MODEL_0d5158380a8b41508dcc73dcd1792577
            value: 5
        6f7a059af7a94d869fbad92c2d874646:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        72906fd562a342029d5f1d56f50fb6de:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_34aee39fccf5435da2e790f5af947d74
            max: 12
            min: 0
            orientation: horizontal
            style: IPY_MODEL_8ae577790abe4a9fb15dc0f8622f922f
            value: 12
        729aa6f69a744dcebe635e65917348df:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_008c84e25ac144b6a379f9a61a848390
            max: 12
            min: 0
            orientation: horizontal
            style: IPY_MODEL_c79ed418712d481f89f5d5ea387c9463
            value: 12
        7329444f88384c5689c148eb4e333a2e:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        73835e3d8b2c4c39b6e19d5b32a38db4:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        745ef28fe1e44fc0a0682615b39fbf9f:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        7499e279a3664d1c9826c47eea5a5a8b:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_356ad9c9a31046d588fc6642f99d2ded
            placeholder: ​
            style: IPY_MODEL_b268d53ea9ed4d14835f15bf42e92a5a
            value: " 12/12 \\[00:00&lt;00:00, 16.81it/s\\]"
        753537acad114fff88c9bd9baad991a3:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        757b2c3a46e14e01b502cdf4ac05df94:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_617b15ca8e37404580b3d082fdb3da91
            placeholder: ​
            style: IPY_MODEL_f05ea406e26847669f5b93546715915a
            value: 100%
        75cb7b7f06564e8aaa00b64b77d85da2:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_f79737c6b69446f8a73a2766974871a1
            placeholder: ​
            style: IPY_MODEL_8f9d07ed33d5456983e92d83f56553c9
            value: 100%
        764ad589ff0448a6b2270a090c99326c:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        77f17bebe57f46ba9ec8f22a5194b723:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        78e447dc0734484086a00cdfde00f82d:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        7ac79a68ff424a71bc26c0d9ba7fab7c:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        7b3d0138c3484c0e9012785a8c4c3f9e:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_7b9e11dbc58245c5b2ce1f49b455aa52
            placeholder: ​
            style: IPY_MODEL_816025235a264775b827dbe48813e432
            value: 100%
        7b9e11dbc58245c5b2ce1f49b455aa52:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        7bf6af490df94601904c70bd76ef64cf:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_9cd24c097cd34a36a7085ff1bb418dde
            placeholder: ​
            style: IPY_MODEL_68f719d6cbfd4cbe9f473c25e0ff49e3
            value: 100%
        7c775522d6df4de2bbadfc7e52d177ef:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        7c9eea8042134b0584025a570430cffd:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_c94abe4cf261414ba681617fb7feabbf
            placeholder: ​
            style: IPY_MODEL_ed273444a5de4490b9e25710c2fd4109
            value: 100%
        7ce3181ee78a445f9238983951948784:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        7d81e4e1926e421fbeccbfcd8d4c0f9d:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_06efaf8e30a44e8fb043e3ca0c1a82ad
            placeholder: ​
            style: IPY_MODEL_559f4a9b82984ea794793813d19f9479
            value: 100%
        7e34855d620b455da8d62ec7cdba7a96:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_64142db73ea94c1f9cc8a6d003ae4453
            - IPY_MODEL_72906fd562a342029d5f1d56f50fb6de
            - IPY_MODEL_9fd041eae9fa439084ddcef95b6a701a
            layout: IPY_MODEL_696c965ee99c48cd9fa2c76479a52ad5
        7e8b657936f34d10b40aa70443ab7e4b:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_7b3d0138c3484c0e9012785a8c4c3f9e
            - IPY_MODEL_6c2d3e30a3ac44b59970cf7b101ba5ea
            - IPY_MODEL_aa8e80bd78d44218ad438139709e06ac
            layout: IPY_MODEL_10266a64e00b4d1c88aba40dc6467232
        8097588cf530476889d60e0cbd0a379b:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_09d869bf817042d2a5e312af8be63f69
            placeholder: ​
            style: IPY_MODEL_2b5fe2ac6d8b458dace0f04886e0a31a
            value: " 12/12 \\[00:00&lt;00:00, 16.96it/s\\]"
        81480510680a40568d05a7bf4d3752bb:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_87ea491f8b4146d787d195d0c0365774
            placeholder: ​
            style: IPY_MODEL_296ccbc1f7474cba91b08b4ad2c3b41f
            value: 100%
        816025235a264775b827dbe48813e432:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        81e3cfc65ace434280c076cea242c0a2:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        81e69a8cad314284b52d605d6adddb64:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        8600065105424566bba038d79dc53e7a:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_499b122d4c0544ba92f98eae610f615f
            - IPY_MODEL_9c4d507c23e3422ea1aff33f6b447583
            - IPY_MODEL_7499e279a3664d1c9826c47eea5a5a8b
            layout: IPY_MODEL_c490077a3f434b6a933821716292a35c
        8677aff8d8d8482bb5e4ae0be05018c9:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_77f17bebe57f46ba9ec8f22a5194b723
            placeholder: ​
            style: IPY_MODEL_f4b48f73d70140a283844190e8ec2382
            value: 100%
        87ea491f8b4146d787d195d0c0365774:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        898fe56b5f5c4e6b97b402e7a8f18fcd:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        8acd8eebdaf34fac989baaa11bf3ac96:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        8ae577790abe4a9fb15dc0f8622f922f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        8c0835b1ac8a41929e2dd109cf607530:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_7c9eea8042134b0584025a570430cffd
            - IPY_MODEL_4bb9af3e5157436c94905c4ba7b77c3e
            - IPY_MODEL_f1b220df91874f53bc915ed438824bbb
            layout: IPY_MODEL_eeb12bbb1af5480096c7c521dfd6f50d
        8c12399b10884985b4c850b7bc6bd805:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        8c85389cb8634fa1adc1daf3bab2b296:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        8dec8d54a7ac4b4aa262165c22fc70c9:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        8f9d07ed33d5456983e92d83f56553c9:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        92888c0aeef94bfb9d5cb9329f0a1c2e:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        9611a9dd3ba94092b959a57f03e03dd5:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        96ff4d8b60b04227baf24bf876a753ca:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        9775e1a05a1e41ebb1a265fbedc5d593:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_2a47589ca3054d4e9ca8cdfec43bacfc
            - IPY_MODEL_9879d2638f634f9fa7d1c300668e0ac0
            - IPY_MODEL_01338ac57ce1452a8f1fb618c5b01118
            layout: IPY_MODEL_99a2840fad6549909d0914bbb3038db7
        979e9b75189446c2bb9775800c91108f:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        9879d2638f634f9fa7d1c300668e0ac0:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_764ad589ff0448a6b2270a090c99326c
            max: 5
            min: 0
            orientation: horizontal
            style: IPY_MODEL_3de683c3b97e4e9b8a0d74aa7e452334
            value: 5
        98d28a6057044d0db96555945fe3debf:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        99a2840fad6549909d0914bbb3038db7:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        9b281305573c429b9eb5808bc9f16203:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        9b304d4449cc4fb599e5459140050231:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_b623b455187147239291b7d657773414
            placeholder: ​
            style: IPY_MODEL_61c769d30826410aa9109033bc52c930
            value: " 12/12 \\[00:00&lt;00:00, 16.24it/s\\]"
        9c2248989a934fd8a7c75185493013e0:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_e0196f38f49840b68c62bab225a4fcd8
            placeholder: ​
            style: IPY_MODEL_a171668d7a1e450690e092ccdc268124
            value: 100%
        9c4d507c23e3422ea1aff33f6b447583:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_8c85389cb8634fa1adc1daf3bab2b296
            max: 12
            min: 0
            orientation: horizontal
            style: IPY_MODEL_ce53eb12dc89493c8d7b3f25485fe36f
            value: 12
        9cd24c097cd34a36a7085ff1bb418dde:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        9cdbc41fe9274de1948dc188daa24f98:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        9dcbee831daa47ce8c61b64d46e09a7a:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        9e0e75ad889f40f78d4e3d072de18109:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        9e2938f632de4cab8dfb8c86c68ba2e7:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        9fd041eae9fa439084ddcef95b6a701a:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_745ef28fe1e44fc0a0682615b39fbf9f
            placeholder: ​
            style: IPY_MODEL_78e447dc0734484086a00cdfde00f82d
            value: " 12/12 \\[00:00&lt;00:00, 16.90it/s\\]"
        a0ac7771fb494a709ef7c46a02f5a753:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_f8370f0a58494777bb1b73c1b5b0ed61
            - IPY_MODEL_ce439d384066420a98437fabae93d385
            - IPY_MODEL_e1832b5266c64d34b075b951b310ce3b
            layout: IPY_MODEL_979e9b75189446c2bb9775800c91108f
        a171668d7a1e450690e092ccdc268124:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        a38905fa0de64e2e8225736b0819ca99:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        a3ecc5574c46482ea00ce02e798fd5d4:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        a4c414ea90fd4ee99322e35746e63151:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        a545aca8631f42b694713344cb97e74c:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        a636cf2d1fc540efbcba8f04dfe77e43:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_d79b64bd106348958268a64fc763b7b2
            max: 12
            min: 0
            orientation: horizontal
            style: IPY_MODEL_e8b553ddc4d84fec82aeb885f4bfcc06
            value: 12
        a6d428c2bb204516b35352176a57cedb:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        a83d7dda6af14dfea724ebe20c622c07:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        a88d1c07c655425f947f79fadb607275:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        a9965038167d4c4c835dcde09dfb85f8:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_9c2248989a934fd8a7c75185493013e0
            - IPY_MODEL_ae739046e4cf4837ad6379b1ecb01aed
            - IPY_MODEL_e39ccc3bb92c4f549dbbb8d71bdcd04f
            layout: IPY_MODEL_0e106349935a41e09d1a37160d23d603
        aa0fc145b54e46df99877646ff1e0563:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_e3f7ac810ea84f6c813a2ad73205ec55
            - IPY_MODEL_2dade71916784e0e9ffe69083edce128
            - IPY_MODEL_9b304d4449cc4fb599e5459140050231
            layout: IPY_MODEL_11cf0333130a4eed964e9cc84929ae1f
        aa8e80bd78d44218ad438139709e06ac:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_11032fd7cff446c9b17a23e8fc9ac620
            placeholder: ​
            style: IPY_MODEL_a88d1c07c655425f947f79fadb607275
            value: " 5/5 \\[00:00&lt;00:00, 16.09it/s\\]"
        ae739046e4cf4837ad6379b1ecb01aed:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_8dec8d54a7ac4b4aa262165c22fc70c9
            max: 5
            min: 0
            orientation: horizontal
            style: IPY_MODEL_b626c52ece2943aab9bdcb57800ff01b
            value: 5
        b268d53ea9ed4d14835f15bf42e92a5a:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        b27300bfc9124bca88e9df2f2931899a:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        b3075f695d9f4e7faabdedc17d261ae1:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        b42b0cfb1d56424c8ab9947e490ba1bd:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_b3075f695d9f4e7faabdedc17d261ae1
            placeholder: ​
            style: IPY_MODEL_2d294d15bff9432eb1b4c9aedbee6555
            value: " 5/5 \\[00:00&lt;00:00, 16.53it/s\\]"
        b527117cb876485cbd61589f79694c37:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        b5ee5c7dcf16425bbb9db085e98dcf59:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_26c8ff9d6b914798b89098849eeed189
            placeholder: ​
            style: IPY_MODEL_2a3db87259734ca7bc08ebadbb7e2313
            value: " 5/5 \\[00:00&lt;00:00, 15.58it/s\\]"
        b623b455187147239291b7d657773414:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        b626c52ece2943aab9bdcb57800ff01b:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        b6f5e8b6cf5a48dab12a522434945e00:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_3949b430b0f54b869c9bf63331217367
            placeholder: ​
            style: IPY_MODEL_26494a3eaf884ecd86450956533d94a4
            value: " 5/5 \\[00:00&lt;00:00, 16.61it/s\\]"
        b8663f73014f471bb324531dad3818c9:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_07b86262379047938d204ea7a0e8be30
            max: 5
            min: 0
            orientation: horizontal
            style: IPY_MODEL_17d5463f266243c7823d0c0840118cf0
            value: 5
        b906ceb2b7c8453681df7972f90a6ef4:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        ba195e8ffe9746fc93cd36d0c3e7b9ec:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_898fe56b5f5c4e6b97b402e7a8f18fcd
            max: 5
            min: 0
            orientation: horizontal
            style: IPY_MODEL_1d0048d0f19441d893477af4f2137d6d
            value: 5
        ba5f5fa8f29f4b559cb390f29b999f3a:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        bc252749f0784bb7a15d1a4b0686e1c7:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_2dddaff64d334046945ccba5a506864c
            max: 12
            min: 0
            orientation: horizontal
            style: IPY_MODEL_96ff4d8b60b04227baf24bf876a753ca
            value: 12
        bd10a0ba2dbb44259dffea066d1e5e80:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        bd44bdd089ce465aa804cc0a887ac2bc:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        be96f921fd044261a1c9eee076b6972c:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        c1d4f0cce5ec4aa8a1a71c7d56659c0f:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        c490077a3f434b6a933821716292a35c:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        c588c87e42494904a4032e95bdc9e360:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_27c57e87a5a94fbfa0901e32f6673e3d
            placeholder: ​
            style: IPY_MODEL_eb4b33ab330b4e4aadf45a026ad8be01
            value: " 12/12 \\[00:00&lt;00:00, 17.22it/s\\]"
        c63a3eb27436466ea303e2be9cd5e2eb:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        c69df1206bec4c71a353a4bd54a6064c:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        c79ed418712d481f89f5d5ea387c9463:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        c90560fd3545425b81149f18faef50c9:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        c94abe4cf261414ba681617fb7feabbf:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        ca2fc170ab6f4a71b9b4972fe249c6d0:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_6f7a059af7a94d869fbad92c2d874646
            placeholder: ​
            style: IPY_MODEL_753537acad114fff88c9bd9baad991a3
            value: 100%
        ccebb77b8027498fb0357d5ed3868075:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        cd0dad519a4a4dfaabb0440ee15fb49a:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        ce439d384066420a98437fabae93d385:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_c1d4f0cce5ec4aa8a1a71c7d56659c0f
            max: 5
            min: 0
            orientation: horizontal
            style: IPY_MODEL_087070c4b4ad443d8a92404566f83d64
            value: 5
        ce53eb12dc89493c8d7b3f25485fe36f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        d0768e0e13cc40ae9263aca68d071a86:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        d1a09e7bd43a41b794d93f9adc12b40a:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        d40c034e37c748b7bfcb350975089bed:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        d52396c2bf69463785df78d3e6dbdeef:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_757b2c3a46e14e01b502cdf4ac05df94
            - IPY_MODEL_daaf93dae5d640e09b19e21c03f684ff
            - IPY_MODEL_58cea40f0aeb4447ba97a734b3104a17
            layout: IPY_MODEL_d8c2faee183d46cc9bfe3fafd6a26d8a
        d668986e40d14953926809ef93357034:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_20cce9b7c3e14e70a095d47382d8ba5d
            placeholder: ​
            style: IPY_MODEL_9b281305573c429b9eb5808bc9f16203
            value: " 12/12 \\[00:00&lt;00:00, 17.27it/s\\]"
        d6b63c9828c146a4a11cff5c400166ac:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_f28f20ddfd344f5e8e26633ad48085a6
            placeholder: ​
            style: IPY_MODEL_7ac79a68ff424a71bc26c0d9ba7fab7c
            value: " 5/5 \\[00:00&lt;00:00, 15.93it/s\\]"
        d79b64bd106348958268a64fc763b7b2:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        d8c079c4cf6145c7b16b8fdc6df03996:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_75cb7b7f06564e8aaa00b64b77d85da2
            - IPY_MODEL_4f1141211bc1480b865bc10630231f2e
            - IPY_MODEL_c588c87e42494904a4032e95bdc9e360
            layout: IPY_MODEL_cd0dad519a4a4dfaabb0440ee15fb49a
        d8c2faee183d46cc9bfe3fafd6a26d8a:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        daaf93dae5d640e09b19e21c03f684ff:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: FloatProgressModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: FloatProgressModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: ProgressView
            bar_style: success
            layout: IPY_MODEL_699f1d9ee1f54e67bd1c986e98796f64
            max: 5
            min: 0
            orientation: horizontal
            style: IPY_MODEL_3fb0214dc4c744aebd62cd1720cd95bb
            value: 5
        e01689e265544115b229f36ddb25b663:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HBoxModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HBoxModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HBoxView
            children:
            - IPY_MODEL_16c686fe8f5245cebe4c37a969fa9b01
            - IPY_MODEL_ba195e8ffe9746fc93cd36d0c3e7b9ec
            - IPY_MODEL_0f21a08f5c7f424baabf545432b43b38
            layout: IPY_MODEL_e465ec4c79484e01befa2c1a23f67634
        e0196f38f49840b68c62bab225a4fcd8:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        e1832b5266c64d34b075b951b310ce3b:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_f47eacffb05744d1af8c34f7d0e422e8
            placeholder: ​
            style: IPY_MODEL_018c5ee3c82f48ab84bf7a63a80a3c8d
            value: " 5/5 \\[00:00&lt;00:00, 15.56it/s\\]"
        e1a6c6892b0545d587da52060da0a030:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        e3983ec8ac9d4b7f94a253ac2c1ff680:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        e39ccc3bb92c4f549dbbb8d71bdcd04f:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_73835e3d8b2c4c39b6e19d5b32a38db4
            placeholder: ​
            style: IPY_MODEL_58191943215d4e20a3e5bab52c78159b
            value: " 5/5 \\[00:00&lt;00:00, 11.01it/s\\]"
        e3f7ac810ea84f6c813a2ad73205ec55:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_8c12399b10884985b4c850b7bc6bd805
            placeholder: ​
            style: IPY_MODEL_ccebb77b8027498fb0357d5ed3868075
            value: 100%
        e4175a8b9ed04077a051898031de86d6:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        e465ec4c79484e01befa2c1a23f67634:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        e884fe92c04640a78febe4e14b38fe8e:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        e8b553ddc4d84fec82aeb885f4bfcc06:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: ProgressStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: ProgressStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        eb4b33ab330b4e4aadf45a026ad8be01:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        ed273444a5de4490b9e25710c2fd4109:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        eeb12bbb1af5480096c7c521dfd6f50d:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        f05ea406e26847669f5b93546715915a:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        f1b220df91874f53bc915ed438824bbb:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_a3ecc5574c46482ea00ce02e798fd5d4
            placeholder: ​
            style: IPY_MODEL_34d5e9cdadd44eceb0c9b0d32c2ab1ea
            value: " 12/12 \\[00:00&lt;00:00, 15.24it/s\\]"
        f28f20ddfd344f5e8e26633ad48085a6:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        f388dfa2b8944cf4803927769d19a9e7:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        f439cb97e77f4bdab3a15d81b81181e8:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        f47eacffb05744d1af8c34f7d0e422e8:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        f4b48f73d70140a283844190e8ec2382:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: DescriptionStyleModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: DescriptionStyleModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: StyleView
        f79737c6b69446f8a73a2766974871a1:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        f8370f0a58494777bb1b73c1b5b0ed61:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_505914312e8444e8841cf3e10232fed9
            placeholder: ​
            style: IPY_MODEL_e884fe92c04640a78febe4e14b38fe8e
            value: 100%
        f917f525d2dc4b3c8bc7fc683396d5e7:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        fd643449dd984b5ba37febcb7c1e8c81:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        fe7120f4bb6b4eda963a5d3d0e61da80:
          model_module: \@jupyter-widgets/base
          model_module_version: 1.2.0
          model_name: LayoutModel
          state:
            _model_module: \@jupyter-widgets/base
            _model_module_version: 1.2.0
            _model_name: LayoutModel
            _view_module: \@jupyter-widgets/base
            _view_module_version: 1.2.0
            _view_name: LayoutView
        fee276819fd5452ba48a8eab13badb1c:
          model_module: \@jupyter-widgets/controls
          model_module_version: 1.5.0
          model_name: HTMLModel
          state:
            _model_module: \@jupyter-widgets/controls
            _model_module_version: 1.5.0
            _model_name: HTMLModel
            _view_module: \@jupyter-widgets/controls
            _view_module_version: 1.5.0
            _view_name: HTMLView
            layout: IPY_MODEL_c63a3eb27436466ea303e2be9cd5e2eb
            placeholder: ​
            style: IPY_MODEL_ba5f5fa8f29f4b559cb390f29b999f3a
            value: 100%
      version_major: 2
      version_minor: 0
---

::: {.cell .code papermill="{\"status\":\"completed\",\"duration\":1.4369e-2,\"end_time\":\"2022-10-13T14:19:03.986342\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:03.971973\"}" tags="[]"}
``` {.python}
```
:::

::: {.cell .markdown papermill="{\"status\":\"completed\",\"duration\":1.2123e-2,\"end_time\":\"2022-10-13T14:19:04.010980\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:03.998857\"}" tags="[]"}
```{=html}
<p style="background-color:#90EE90;color:black;font-size:45px;text-align:center;border-radius:9px 9px;font-weight:bold;border:2px black;">Titanic - SVM and RF Parameters and Deep Learning</p>
```
:::

::: {.cell .code execution_count="1" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:04.039000Z\",\"iopub.status.idle\":\"2022-10-13T14:19:04.044511Z\",\"iopub.execute_input\":\"2022-10-13T14:19:04.039773Z\",\"shell.execute_reply\":\"2022-10-13T14:19:04.043712Z\"}" papermill="{\"status\":\"completed\",\"duration\":2.1583e-2,\"end_time\":\"2022-10-13T14:19:04.046624\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:04.025041\"}" tags="[]"}
``` {.python}
# Project Planning --
# 1. The first thing we want to do is an inspection of the data
# 2. Cleaning the data (NaNs, incorrect values, etc)
# 3. Transform the data and create dummy variables
# 4. The plan is to run both a RandomForest and SVM model
# 5. We want the models to be tuned to their best parameters so we will attempt to write a script to do that
# 6. We will then see the best feature parameters of both the models to use for deep learning
# 7. The deep model will be handled with Keras. We want to first explore the different optimizers (We will run a model using each one and see the different accuracies)
# 8. We will then use the best optimizer to create the final fit using K-fold cross-validation over 10 cycles.
```
:::

::: {.cell .markdown papermill="{\"status\":\"completed\",\"duration\":1.1968e-2,\"end_time\":\"2022-10-13T14:19:04.071110\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:04.059142\"}" tags="[]"}
## `<p style="background-color:#90EE90;color:black;font-size:30px;text-align:center;border-radius:12px 10px;border:2px;">`{=html} Here is the whole dataset `</p>`{=html} {#-here-is-the-whole-dataset-}

`<font size="4">`{=html}The dataset contains ten categories/variables
with 891 passenger details. Survived is the response variable for the
study. We are also given a seperate \"test\" set of data that does not
give a survival result `</font>`{=html} `<p>`{=html}`</p>`{=html}

```{=html}
<table style="border-collapse: collapse;font-size: 15px; width:800px;">
  <tr>
    <th style="background-color:#D3DBDD;">Variable Name </th>
    <th style="width:500px; background-color:#D3DBDD;">Description</th>
    <th style="background-color:#D3DBDD;">Type</th>
  </tr>
  <tr>
    <td>survival</td>
    <td>Did Survive the incident?</td>
    <td>Categoricol</td>
  </tr>
  <tr>
    <td>pclass </td>
    <td>Class of the ticket</td>
    <td>Categoricol</td>
  </tr>
  <tr>
    <td>sex </td>
    <td>Gender </td>
    <td>Categoricol</td>
  </tr>
  <tr>
    <td>Age </td>
    <td>Age of the passenger</td>
    <td>Numeric</td>
  </tr>
  <tr>
    <td>sibsp </td>
    <td>no of siblings / spouses aboard the Titanic </td>
    <td>Numeric</td>
  </tr>
  <tr>
    <td>parch</td>
    <td>no of parents / children aboard the Titanic</td>
    <td>Numeric</td>
  </tr>
  <tr>
    <td>ticket</td>
    <td>Unique ticket number</td>
    <td>Categoricol</td>
  </tr>
  <tr>
    <td>fare</td>
    <td>Passenger fare </td>
    <td>Numeric</td>
  </tr>
  <tr>
    <td>cabin</td>
    <td>cabin number </td>
    <td>Categoricol</td>
  </tr>
  <tr>
    <td>Embarked</td>
    <td>Port of Embarkation</td>
    <td>Categoricol</td>
  </tr>
</table>
```
:::

::: {.cell .markdown papermill="{\"status\":\"completed\",\"duration\":1.2064e-2,\"end_time\":\"2022-10-13T14:19:04.095506\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:04.083442\"}" tags="[]"}
## `<p style="background-color:#90EE90;color:black;font-size:30px;text-align:center;border-radius:12px 10px;border:2px;">`{=html} 1. Data Inspection and Exploration `</p>`{=html} {#-1-data-inspection-and-exploration-}

`<font size="4">`{=html} First we are going to do some simple data
exploration, getting a feel for the different values used.
`</font>`{=html} `<p>`{=html}`</p>`{=html}
:::

::: {.cell .code execution_count="2" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:04.123777Z\",\"iopub.status.idle\":\"2022-10-13T14:19:05.460538Z\",\"iopub.execute_input\":\"2022-10-13T14:19:04.124519Z\",\"shell.execute_reply\":\"2022-10-13T14:19:05.459414Z\"}" papermill="{\"status\":\"completed\",\"duration\":1.354982,\"end_time\":\"2022-10-13T14:19:05.463692\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:04.108710\"}" tags="[]"}
``` {.python}
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

gender = pd.read_csv('../input/titanic/gender_submission.csv')

train_data = pd.read_csv('../input/titanic/train.csv')
test_data = pd.read_csv('../input/titanic/test.csv')

train_data['train'] = 1 # here we are defining a column so that we can concatenate the test/train data
test_data['train'] = 0
test_data['Survived'] = np.NaN
all_data = pd.concat([train_data,test_data])

%matplotlib inline
all_data.columns # check the columns
```

::: {.output .execute_result execution_count="2"}
    Index(['PassengerId', 'Survived', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp',
           'Parch', 'Ticket', 'Fare', 'Cabin', 'Embarked', 'train'],
          dtype='object')
:::
:::

::: {.cell .code execution_count="3" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:05.490547Z\",\"iopub.status.idle\":\"2022-10-13T14:19:05.510596Z\",\"iopub.execute_input\":\"2022-10-13T14:19:05.490975Z\",\"shell.execute_reply\":\"2022-10-13T14:19:05.509331Z\"}" papermill="{\"status\":\"completed\",\"duration\":3.8173e-2,\"end_time\":\"2022-10-13T14:19:05.514699\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:05.476526\"}" tags="[]"}
``` {.python}
# checking for dtype, column name, and seeing missing values
train_data.info()
```

::: {.output .stream .stdout}
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 891 entries, 0 to 890
    Data columns (total 13 columns):
     #   Column       Non-Null Count  Dtype  
    ---  ------       --------------  -----  
     0   PassengerId  891 non-null    int64  
     1   Survived     891 non-null    int64  
     2   Pclass       891 non-null    int64  
     3   Name         891 non-null    object 
     4   Sex          891 non-null    object 
     5   Age          714 non-null    float64
     6   SibSp        891 non-null    int64  
     7   Parch        891 non-null    int64  
     8   Ticket       891 non-null    object 
     9   Fare         891 non-null    float64
     10  Cabin        204 non-null    object 
     11  Embarked     889 non-null    object 
     12  train        891 non-null    int64  
    dtypes: float64(2), int64(6), object(5)
    memory usage: 90.6+ KB
:::
:::

::: {.cell .code execution_count="4" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:05.542683Z\",\"iopub.status.idle\":\"2022-10-13T14:19:05.585705Z\",\"iopub.execute_input\":\"2022-10-13T14:19:05.543085Z\",\"shell.execute_reply\":\"2022-10-13T14:19:05.584434Z\"}" papermill="{\"status\":\"completed\",\"duration\":5.9353e-2,\"end_time\":\"2022-10-13T14:19:05.588177\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:05.528824\"}" tags="[]"}
``` {.python}
# getting the descriptive statistics
train_data.describe()
```

::: {.output .execute_result execution_count="4"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
      <th>train</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>714.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.0</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>446.000000</td>
      <td>0.383838</td>
      <td>2.308642</td>
      <td>29.699118</td>
      <td>0.523008</td>
      <td>0.381594</td>
      <td>32.204208</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>std</th>
      <td>257.353842</td>
      <td>0.486592</td>
      <td>0.836071</td>
      <td>14.526497</td>
      <td>1.102743</td>
      <td>0.806057</td>
      <td>49.693429</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.420000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>223.500000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>20.125000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.910400</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>446.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>28.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.454200</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>668.500000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>38.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>31.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>max</th>
      <td>891.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>80.000000</td>
      <td>8.000000</td>
      <td>6.000000</td>
      <td>512.329200</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="5" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:05.615388Z\",\"iopub.status.idle\":\"2022-10-13T14:19:05.623155Z\",\"iopub.execute_input\":\"2022-10-13T14:19:05.615816Z\",\"shell.execute_reply\":\"2022-10-13T14:19:05.622014Z\"}" papermill="{\"status\":\"completed\",\"duration\":2.4075e-2,\"end_time\":\"2022-10-13T14:19:05.625213\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:05.601138\"}" tags="[]"}
``` {.python}
#splitting data into numeric and categorical
dfnum = train_data[['Age','SibSp','Parch','Fare','Survived','Pclass']]
dfcat = train_data[['Sex','Ticket','Cabin','Embarked']]
```
:::

::: {.cell .code execution_count="6" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:05.652801Z\",\"iopub.status.idle\":\"2022-10-13T14:19:05.681978Z\",\"iopub.execute_input\":\"2022-10-13T14:19:05.653199Z\",\"shell.execute_reply\":\"2022-10-13T14:19:05.681054Z\"}" papermill="{\"status\":\"completed\",\"duration\":4.6029e-2,\"end_time\":\"2022-10-13T14:19:05.684247\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:05.638218\"}" tags="[]"}
``` {.python}
dfnum.describe()
```

::: {.output .execute_result execution_count="6"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
      <th>Survived</th>
      <th>Pclass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>714.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>29.699118</td>
      <td>0.523008</td>
      <td>0.381594</td>
      <td>32.204208</td>
      <td>0.383838</td>
      <td>2.308642</td>
    </tr>
    <tr>
      <th>std</th>
      <td>14.526497</td>
      <td>1.102743</td>
      <td>0.806057</td>
      <td>49.693429</td>
      <td>0.486592</td>
      <td>0.836071</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.420000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>20.125000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.910400</td>
      <td>0.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>28.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.454200</td>
      <td>0.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>38.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>31.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>80.000000</td>
      <td>8.000000</td>
      <td>6.000000</td>
      <td>512.329200</td>
      <td>1.000000</td>
      <td>3.000000</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="7" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:05.711713Z\",\"iopub.status.idle\":\"2022-10-13T14:19:05.731971Z\",\"iopub.execute_input\":\"2022-10-13T14:19:05.712124Z\",\"shell.execute_reply\":\"2022-10-13T14:19:05.731121Z\"}" papermill="{\"status\":\"completed\",\"duration\":3.7012e-2,\"end_time\":\"2022-10-13T14:19:05.734333\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:05.697321\"}" tags="[]"}
``` {.python}
dfcat.describe()
```

::: {.output .execute_result execution_count="7"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sex</th>
      <th>Ticket</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>891</td>
      <td>891</td>
      <td>204</td>
      <td>889</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>2</td>
      <td>681</td>
      <td>147</td>
      <td>3</td>
    </tr>
    <tr>
      <th>top</th>
      <td>male</td>
      <td>347082</td>
      <td>B96 B98</td>
      <td>S</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>577</td>
      <td>7</td>
      <td>4</td>
      <td>644</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .code execution_count="8" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:05.762755Z\",\"iopub.status.idle\":\"2022-10-13T14:19:06.112035Z\",\"iopub.execute_input\":\"2022-10-13T14:19:05.763137Z\",\"shell.execute_reply\":\"2022-10-13T14:19:06.110698Z\"}" papermill="{\"status\":\"completed\",\"duration\":0.366849,\"end_time\":\"2022-10-13T14:19:06.114700\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:05.747851\"}" tags="[]"}
``` {.python}
# here is a heatmap of the correlations between the 4 numeric variables
# as we can see there is a relationship between parch+sibsp (num of parents + num of siblings)
print(dfnum.corr())
sns.heatmap(dfnum.corr())
```

::: {.output .stream .stdout}
                   Age     SibSp     Parch      Fare  Survived    Pclass
    Age       1.000000 -0.308247 -0.189119  0.096067 -0.077221 -0.369226
    SibSp    -0.308247  1.000000  0.414838  0.159651 -0.035322  0.083081
    Parch    -0.189119  0.414838  1.000000  0.216225  0.081629  0.018443
    Fare      0.096067  0.159651  0.216225  1.000000  0.257307 -0.549500
    Survived -0.077221 -0.035322  0.081629  0.257307  1.000000 -0.338481
    Pclass   -0.369226  0.083081  0.018443 -0.549500 -0.338481  1.000000
:::

::: {.output .execute_result execution_count="8"}
    <AxesSubplot:>
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/99260c2ede08e487d30ef4511e7413d8c27ddf7c.png)
:::
:::

::: {.cell .code execution_count="9" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:06.144294Z\",\"iopub.status.idle\":\"2022-10-13T14:19:06.153217Z\",\"iopub.execute_input\":\"2022-10-13T14:19:06.145236Z\",\"shell.execute_reply\":\"2022-10-13T14:19:06.152087Z\"}" papermill="{\"status\":\"completed\",\"duration\":2.6798e-2,\"end_time\":\"2022-10-13T14:19:06.155691\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:06.128893\"}" tags="[]"}
``` {.python}
pd.options.mode.chained_assignment = None  # default='warn'
dfnum.Age = dfnum.Age.fillna(dfnum.Age.mean())
dfnum.Fare = dfnum.Fare.fillna(dfnum.Fare.median())
```
:::

::: {.cell .code execution_count="10" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:06.184456Z\",\"iopub.status.idle\":\"2022-10-13T14:19:07.310846Z\",\"iopub.execute_input\":\"2022-10-13T14:19:06.184868Z\",\"shell.execute_reply\":\"2022-10-13T14:19:07.309560Z\"}" papermill="{\"status\":\"completed\",\"duration\":1.143842,\"end_time\":\"2022-10-13T14:19:07.313322\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:06.169480\"}" tags="[]"}
``` {.python}
plt.figure(figsize=[16,12])
from scipy import stats


plt.subplot(231)
sns.histplot(all_data['Age'],kde=True)
plt.title('Age')
plt.xlabel(f'Shapiro test: {round(stats.shapiro(dfnum["Age"]).pvalue,6)}')

plt.subplot(232)
sns.histplot(all_data['SibSp'],kde=True)
plt.title('SibSp')
plt.xlabel(f'Shapiro test: {np.round(stats.shapiro(dfnum["SibSp"]).pvalue,6)}')

plt.subplot(233)
sns.histplot(all_data['Parch'],kde=True)
plt.title('Parch')
plt.xlabel(f'Shapiro test: {np.round(stats.shapiro(dfnum["Parch"]).pvalue,6)}')

plt.subplot(234)
sns.histplot(all_data['Survived'],kde=True)
plt.title('Survived')
plt.xlabel(f'Shapiro test: {np.round(stats.shapiro(dfnum["Survived"]).pvalue,6)}')

plt.subplot(235)
sns.histplot(all_data['Pclass'],kde=True)
plt.title('Pclass')
plt.xlabel(f'Shapiro test: {np.round(stats.shapiro(dfnum["Pclass"]).pvalue,6)}')

```

::: {.output .execute_result execution_count="10"}
    Text(0.5, 0, 'Shapiro test: 0.0')
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/2ac620dd95d5012b295be59543d41987fab72182.png)
:::
:::

::: {.cell .code execution_count="11" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:07.345564Z\",\"iopub.status.idle\":\"2022-10-13T14:19:08.091924Z\",\"iopub.execute_input\":\"2022-10-13T14:19:07.345995Z\",\"shell.execute_reply\":\"2022-10-13T14:19:08.091087Z\"}" papermill="{\"status\":\"completed\",\"duration\":0.765133,\"end_time\":\"2022-10-13T14:19:08.094088\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:07.328955\"}" tags="[]"}
``` {.python}
# printing out some stacked histograms and some box plots for age and fare

plt.figure(figsize=[16,12])

# the fare data looks to be fairly skewed and we know from the shapiro test that it's not parametric
plt.subplot(231)
plt.boxplot(x=dfnum['Fare'], showmeans = True, meanline = True)
plt.title('Fare Boxplot')
plt.ylabel('Fare ($)')

# the same can be said for the age data - its looking likely that we will use either median or mode to fill in NA values
plt.subplot(232)
plt.boxplot(dfnum['Age'], showmeans = True, meanline = True)
plt.title('Age Boxplot')
plt.ylabel('Age (Years)')

# just a quick look to see if there is any obvious visual correlation between fare and survival
plt.subplot(233)
plt.hist(x = [dfnum[dfnum['Survived']==1]['Fare'], dfnum[dfnum['Survived']==0]['Fare']], 
         stacked=True, color = ['g','r'],label = ['Survived','Dead'])
plt.title('Fare Histogram by Survival')
plt.xlabel('Fare ($)')
plt.ylabel('# of Passengers')
plt.legend()

# and doing the same for age
plt.subplot(234)
plt.hist(x = [dfnum[dfnum['Survived']==1]['Age'], dfnum[dfnum['Survived']==0]['Age']], 
         stacked=True, color = ['g','r'],label = ['Survived','Dead'])
plt.title('Age Histogram by Survival')
plt.xlabel('Age (Years)')
plt.ylabel('# of Passengers')
plt.legend()

```

::: {.output .execute_result execution_count="11"}
    <matplotlib.legend.Legend at 0x7f77190a6590>
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/1237a0cfb86ba227c788a8bcf085e3a7eadfdfbb.png)
:::
:::

::: {.cell .code execution_count="12" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:08.127568Z\",\"iopub.status.idle\":\"2022-10-13T14:19:08.134274Z\",\"iopub.execute_input\":\"2022-10-13T14:19:08.128700Z\",\"shell.execute_reply\":\"2022-10-13T14:19:08.133412Z\"}" papermill="{\"status\":\"completed\",\"duration\":2.6388e-2,\"end_time\":\"2022-10-13T14:19:08.136424\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:08.110036\"}" tags="[]"}
``` {.python}
dfcat.columns
```

::: {.output .execute_result execution_count="12"}
    Index(['Sex', 'Ticket', 'Cabin', 'Embarked'], dtype='object')
:::
:::

::: {.cell .code execution_count="13" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:08.170872Z\",\"iopub.status.idle\":\"2022-10-13T14:19:20.832083Z\",\"iopub.execute_input\":\"2022-10-13T14:19:08.171720Z\",\"shell.execute_reply\":\"2022-10-13T14:19:20.830983Z\"}" papermill="{\"status\":\"completed\",\"duration\":12.681285,\"end_time\":\"2022-10-13T14:19:20.834490\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:08.153205\"}" tags="[]"}
``` {.python}
plt.figure(figsize=[16,12])
from scipy import stats


plt.subplot(231)
sns.barplot(x=dfcat['Sex'].value_counts().index,y=dfcat['Sex'].value_counts()).set(title='Sex')
plt.subplot(232)
sns.barplot(x=dfcat['Ticket'].value_counts().index,y=dfcat['Ticket'].value_counts()).set(title='Ticket')
plt.subplot(233)
sns.barplot(x=dfcat['Cabin'].value_counts().index,y=dfcat['Cabin'].value_counts()).set(title='Cabin')
plt.subplot(234)
sns.barplot(x=dfcat['Embarked'].value_counts().index,y=dfcat['Embarked'].value_counts()).set(title='Embarked')

# now looking at some of the categorical data descriptives
```

::: {.output .execute_result execution_count="13"}
    [Text(0.5, 1.0, 'Embarked')]
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/677648d8210ee93aa5b3f158fbfd887a208e8571.png)
:::
:::

::: {.cell .code execution_count="14" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:20.868501Z\",\"iopub.status.idle\":\"2022-10-13T14:19:20.881004Z\",\"iopub.execute_input\":\"2022-10-13T14:19:20.869104Z\",\"shell.execute_reply\":\"2022-10-13T14:19:20.879957Z\"}" papermill="{\"status\":\"completed\",\"duration\":3.239e-2,\"end_time\":\"2022-10-13T14:19:20.883239\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:20.850849\"}" tags="[]"}
``` {.python}
# noticed that some passengers had multiple rooms, thought it was worth exploring separately
train_data['cabin_multiple'] = train_data.Cabin.apply(lambda x: 0 if pd.isna(x) else len(x.split(' ')))
train_data['cabin_multiple'].value_counts()
```

::: {.output .execute_result execution_count="14"}
    0    687
    1    180
    2     16
    3      6
    4      2
    Name: cabin_multiple, dtype: int64
:::
:::

::: {.cell .code execution_count="15" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:20.918311Z\",\"iopub.status.idle\":\"2022-10-13T14:19:21.231885Z\",\"iopub.execute_input\":\"2022-10-13T14:19:20.919366Z\",\"shell.execute_reply\":\"2022-10-13T14:19:21.230683Z\"}" papermill="{\"status\":\"completed\",\"duration\":0.334154,\"end_time\":\"2022-10-13T14:19:21.234274\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:20.900120\"}" tags="[]"}
``` {.python}
plt.figure(figsize=[16,12])

plt.subplot(231)
plt.hist(x = [train_data[train_data['Survived']==1]['cabin_multiple'], train_data[train_data['Survived']==0]['cabin_multiple']], 
         stacked=True, color = ['g','r'],label = ['Survived','Dead'])
plt.title('cabin_multiple Histogram by Survival')
plt.xlabel('# of Cabins')
plt.ylabel('# of Passengers')
plt.legend()


pd.pivot_table(train_data, index = 'Survived', columns = 'cabin_multiple', values = 'Ticket', aggfunc = 'count')

```

::: {.output .execute_result execution_count="15"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>cabin_multiple</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
    <tr>
      <th>Survived</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>481.0</td>
      <td>58.0</td>
      <td>7.0</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>206.0</td>
      <td>122.0</td>
      <td>9.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/4feff5e63f052ec0eb0db91987c1813a0569122e.png)
:::
:::

::: {.cell .code papermill="{\"status\":\"completed\",\"duration\":1.7002e-2,\"end_time\":\"2022-10-13T14:19:21.268131\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:21.251129\"}" tags="[]"}
``` {.python}
```
:::

::: {.cell .markdown papermill="{\"status\":\"completed\",\"duration\":1.6494e-2,\"end_time\":\"2022-10-13T14:19:21.301455\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:21.284961\"}" tags="[]"}
## `<p style="background-color:#90EE90;color:black;font-size:30px;text-align:center;border-radius:12px 10px;border:2px;">`{=html} 2. Data Cleaning and Preprocessing `</p>`{=html} {#-2-data-cleaning-and-preprocessing-}

`<font size="4" color="black">`{=html} Now we are getting to the part
that will differ for most people. We\'ve inspected the data and found
some interesting correlations and nuggets of wisdom. However, choosing
which variables to move forward with is an art not a science and every
data scientist will do something slightly differently.

`<font size="4" color="black">`{=html}I\'ve decided to move forward with
the following variables:`</font>`{=html}

-   `<font size="4" color="black">`{=html}\'Pclass\' \-\-- I\'ve
    separated the classes into separate variables
    (P1,P2,P3)`</font>`{=html}
-   `<font size="4" color="black">`{=html}\'Sex\' \-\-- The sex variable
    is likely to inform the model a lot based on the
    correlations`</font>`{=html}
-   `<font size="4" color="black">`{=html}\'Age\' \-\-- Age seems to be
    an important variable but I will normalise it and clear all
    NAs`</font>`{=html}
-   `<font size="4" color="black">`{=html}\'SibSp\' \-\-- The siblings
    tell us something about traveling with family which may be
    helpful`</font>`{=html}
-   `<font size="4" color="black">`{=html}\'norm_sibsp\' \-\-- Here
    I\'ve normalised the sibling values`</font>`{=html}
-   `<font size="4" color="black">`{=html}\'Parch\' \-\-- Likewise the
    parentage tells us that people are in groups`</font>`{=html}
-   `<font size="4" color="black">`{=html}\'Fare\' \-\-- Fare tells us
    the price of the ticket and is therefore indicative of the wealth of
    the patron`</font>`{=html}
-   `<font size="4" color="black">`{=html}\'norm_fare\' \-\-- I\'ve
    included the normalised price of ticket with NAs
    removed`</font>`{=html}
-   `<font size="4" color="black">`{=html}\'cabin_multiple\' \-\-- If
    the patron had multiple cabins it tells us something about their
    demographic`</font>`{=html}
-   `<font size="4" color="black">`{=html}\'numeric_ticket\' \-\-- The
    ticket number may be informative about the location of the
    cabin`</font>`{=html}
-   `<font size="4" color="black">`{=html}\'Embarked\' \-\-- Perhaps the
    location they embarked from may relate to their cabin location or
    wealth`</font>`{=html}
:::

::: {.cell .code execution_count="16" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:21.337708Z\",\"iopub.status.idle\":\"2022-10-13T14:19:21.362072Z\",\"iopub.execute_input\":\"2022-10-13T14:19:21.338109Z\",\"shell.execute_reply\":\"2022-10-13T14:19:21.361027Z\"}" papermill="{\"status\":\"completed\",\"duration\":4.5505e-2,\"end_time\":\"2022-10-13T14:19:21.364710\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:21.319205\"}" tags="[]"}
``` {.python}
# split up the cabin multiple string using quick expression
all_data['cabin_multiple'] = all_data.Cabin.apply(lambda x: 0 if pd.isna(x) else len(x.split(' ')))

# split the tickets into number tickets and letter tickets
all_data['numeric_ticket'] = all_data.Ticket.apply(lambda x: 1 if x.isnumeric() else 0) # simply binary if they had numbers
all_data['ticket_letters'] = all_data.Ticket.apply(lambda x: ''.join(x.split(' ')[:-1]).replace('.','').replace('/','').lower() if len(x.split(' ')[:-1]) > 0 else 0)

# extract name titles from the beginning of names
all_data.drop(['Name'],axis=1)
#all_data['name_title'] = all_data.Name.apply(lambda x: x.split(',')[1].split('.')[0].strip())

# fill in missing data with median = both age and fare were non-parametric and had very skewed responses so median is more appropriate
all_data.Age = all_data.Age.fillna(train_data.Age.median())
all_data.Fare = all_data.Fare.fillna(train_data.Fare.median())

# remove all the empty values from embarked
all_data.dropna(subset=['Embarked'],inplace = False)

# normalising the sibling and fare data with a log transformation
all_data['norm_sibsp'] = np.log(all_data.SibSp+1)
all_data['norm_fare'] = np.log(all_data.Fare+1)

```
:::

::: {.cell .code execution_count="17" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:21.400413Z\",\"iopub.status.idle\":\"2022-10-13T14:19:23.676415Z\",\"iopub.execute_input\":\"2022-10-13T14:19:21.400875Z\",\"shell.execute_reply\":\"2022-10-13T14:19:23.675263Z\"}" papermill="{\"status\":\"completed\",\"duration\":2.29669,\"end_time\":\"2022-10-13T14:19:23.678899\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:21.382209\"}" tags="[]"}
``` {.python}
plt.figure(figsize=[16,12])

sp_norm_data = pd.get_dummies(all_data[['norm_sibsp','SibSp']])
plt.subplot(231)
sns.histplot(data=sp_norm_data,multiple="stack",kde=True,shrink=1.2)

fare_norm_data = pd.get_dummies(all_data[['norm_fare','Fare']])
plt.subplot(232)
sns.histplot(data=fare_norm_data,multiple="stack",kde=True)

sns.histplot()
```

::: {.output .execute_result execution_count="17"}
    <AxesSubplot:ylabel='Count'>
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/a82903f4f9c7dae66ec75fe027a819b3ceb1ca02.png)
:::
:::

::: {.cell .code execution_count="18" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:23.715834Z\",\"iopub.status.idle\":\"2022-10-13T14:19:24.921941Z\",\"iopub.execute_input\":\"2022-10-13T14:19:23.716720Z\",\"shell.execute_reply\":\"2022-10-13T14:19:24.920954Z\"}" papermill="{\"status\":\"completed\",\"duration\":1.22757,\"end_time\":\"2022-10-13T14:19:24.924152\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:23.696582\"}" tags="[]"}
``` {.python}
# here we are looking at Pclass vs a selection of factors.
fig, (axis1,axis2,axis3,axis4) = plt.subplots(1,4,figsize=(18,14))

sns.boxplot(x='Pclass',y='Fare',hue='Survived',data=all_data,ax=axis1)
axis1.set_title('Pclass vs Fare Survival Comparison')

sns.barplot(x='Pclass',y='Survived',hue='Sex',data=all_data,ax=axis2,orient = "v")
axis2.set_title('Pclass vs Sex Survival Comparison')

sns.boxplot(x= 'Pclass',y='SibSp',hue = 'Survived',data=all_data,ax=axis3)
axis3.set_title('Pclass vs Siblings Survival Comparison')

sns.violinplot(x='Pclass',y='Age',hue='Survived',data=all_data,split=True,ax=axis4)
axis4.set_title('Pclass vs Age Survival Comparison')
```

::: {.output .execute_result execution_count="18"}
    Text(0.5, 1.0, 'Pclass vs Age Survival Comparison')
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/ff7f4848a6b73243170df887ec0f5536a05c1bd6.png)
:::
:::

::: {.cell .code execution_count="19" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:24.964406Z\",\"iopub.status.idle\":\"2022-10-13T14:19:26.776693Z\",\"iopub.execute_input\":\"2022-10-13T14:19:24.964887Z\",\"shell.execute_reply\":\"2022-10-13T14:19:26.775381Z\"}" papermill="{\"status\":\"completed\",\"duration\":1.835946,\"end_time\":\"2022-10-13T14:19:26.779603\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:24.943657\"}" tags="[]"}
``` {.python}
#histogram comparison of sex, class, and age by survival
sca = sns.FacetGrid(all_data, row = 'Sex', col = 'Pclass', hue = 'Survived')
sca.map(plt.hist, 'Age', alpha = .55)
sca.add_legend()
```

::: {.output .execute_result execution_count="19"}
    <seaborn.axisgrid.FacetGrid at 0x7f7715b301d0>
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/6f2bbb6fa7d6ff2d5155839ce5261312804a34c6.png)
:::
:::

::: {.cell .code execution_count="20" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:26.819440Z\",\"iopub.status.idle\":\"2022-10-13T14:19:27.948843Z\",\"iopub.execute_input\":\"2022-10-13T14:19:26.819881Z\",\"shell.execute_reply\":\"2022-10-13T14:19:27.947885Z\"}" papermill="{\"status\":\"completed\",\"duration\":1.153182,\"end_time\":\"2022-10-13T14:19:27.951966\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:26.798784\"}" tags="[]"}
``` {.python}
#correlation heatmap of dataset
def corr_hm(df):
    _ , axis1 = plt.subplots(figsize =(14, 12))
    colormap = sns.diverging_palette(220, 10, as_cmap = True)
    
    _ = sns.heatmap(
        df.corr(method = 'spearman'), 
        cmap = colormap,
        square=True, 
        cbar_kws={'shrink':.9 }, 
        ax=axis1,
        linewidths=0.1,vmax=1.0, linecolor='grey',
        annot=True,
        annot_kws={'fontsize':14 }
    )
    
    plt.title('Spearman Correlation of Features', y=1.05, size=15)

corr_hm(all_data)
```

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/9b9b783ecd22fb78345e4b7bf5683bd077829a58.png)
:::
:::

::: {.cell .markdown papermill="{\"status\":\"completed\",\"duration\":2.0797e-2,\"end_time\":\"2022-10-13T14:19:27.993878\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:27.973081\"}" tags="[]"}
## `<p style="background-color:#90EE90;color:black;font-size:30px;text-align:center;border-radius:12px 10px;border:2px;">`{=html} 3. Transforming the Data and Creating Dummies `</p>`{=html} {#-3-transforming-the-data-and-creating-dummies-}
:::

::: {.cell .code execution_count="21" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:28.037099Z\",\"iopub.status.idle\":\"2022-10-13T14:19:28.062860Z\",\"iopub.execute_input\":\"2022-10-13T14:19:28.037528Z\",\"shell.execute_reply\":\"2022-10-13T14:19:28.061610Z\"}" papermill="{\"status\":\"completed\",\"duration\":5.0381e-2,\"end_time\":\"2022-10-13T14:19:28.065140\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:28.014759\"}" tags="[]"}
``` {.python}
# transforming the class into a string
all_data.Pclass = all_data.Pclass.astype(str)

# create dummies for analysis
all_dummies = pd.get_dummies(all_data[['Pclass','Sex','Age','SibSp','Fare','norm_sibsp','norm_fare','Parch','Embarked',
                                     'cabin_multiple','numeric_ticket','train','Survived']])

# separate the data back into training and testing sets
X_train = all_dummies[all_dummies.train == 1].drop(['train','Survived'], axis = 1)
X_test = all_dummies[all_dummies.train == 0].drop(['train'], axis = 1)

y_train = all_data[all_data.train==1].Survived
y_train.shape
```

::: {.output .execute_result execution_count="21"}
    (891,)
:::
:::

::: {.cell .code execution_count="22" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:28.108838Z\",\"iopub.status.idle\":\"2022-10-13T14:19:28.283978Z\",\"iopub.execute_input\":\"2022-10-13T14:19:28.109874Z\",\"shell.execute_reply\":\"2022-10-13T14:19:28.282798Z\"}" papermill="{\"status\":\"completed\",\"duration\":0.200782,\"end_time\":\"2022-10-13T14:19:28.286807\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:28.086025\"}" tags="[]"}
``` {.python}
from sklearn.preprocessing import StandardScaler
scale = StandardScaler()

# now we are transforming the values into something scaled using StandardScaler from sklearn
all_dummies_scaled = all_dummies.copy()
all_dummies_scaled[['Age','SibSp','Parch','norm_fare']] = scale.fit_transform(all_dummies_scaled[['Age','SibSp','Parch','norm_fare']])

# we are then separating the training and testing sets out with the scaled data
X_train_scaled = all_dummies_scaled[all_dummies_scaled.train == 1].drop(['train','Survived'], axis = 1)
X_test_scaled = all_dummies_scaled[all_dummies_scaled.train == 0].drop(['train'], axis = 1)

y_train = all_data[all_data.train == 1].Survived
```
:::

::: {.cell .markdown papermill="{\"status\":\"completed\",\"duration\":2.1244e-2,\"end_time\":\"2022-10-13T14:19:28.329931\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:28.308687\"}" tags="[]"}
## `<p style="background-color:#90EE90;color:black;font-size:30px;text-align:center;border-radius:12px 10px;border:2px;">`{=html} 4. Building the Model `</p>`{=html} {#-4-building-the-model-}
:::

::: {.cell .code execution_count="23" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:28.373999Z\",\"iopub.status.idle\":\"2022-10-13T14:19:28.701764Z\",\"iopub.execute_input\":\"2022-10-13T14:19:28.374860Z\",\"shell.execute_reply\":\"2022-10-13T14:19:28.700465Z\"}" papermill="{\"status\":\"completed\",\"duration\":0.354033,\"end_time\":\"2022-10-13T14:19:28.705193\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:28.351160\"}" tags="[]"}
``` {.python}
from sklearn.model_selection import cross_val_score
from sklearn import tree
from sklearn.ensemble import RandomForestClassifier
from sklearn.svm import SVC
from sklearn.inspection import permutation_importance
from sklearn.model_selection import train_test_split
```
:::

::: {.cell .markdown papermill="{\"status\":\"completed\",\"duration\":2.1731e-2,\"end_time\":\"2022-10-13T14:19:28.749336\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:28.727605\"}" tags="[]"}
`<font size="6" color="black">`{=html} Model Tuning

`<font size="4" color="black">`{=html} For the models we are running a
Random Forest Classifier and a Support Vector Machine. I have run a
GridSearch with different tuning parameters to identify the best setup
to use for these classifiers. For Random Forest that was the following:

`<font size="4" color="black">`{=html}

    bootstrap: True
     
    criterion: gini
     
    max_depth: 15
     
    max_features: 10
     
    min_samples_leaf: 3
     
    min_samples_split: 2
     
    n_estimators: 550
     

`</font>`{=html}
:::

::: {.cell .code execution_count="24" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:28.795292Z\",\"iopub.status.idle\":\"2022-10-13T14:19:30.194366Z\",\"iopub.execute_input\":\"2022-10-13T14:19:28.795793Z\",\"shell.execute_reply\":\"2022-10-13T14:19:30.193325Z\"}" papermill="{\"status\":\"completed\",\"duration\":1.425708,\"end_time\":\"2022-10-13T14:19:30.197167\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:28.771459\"}" tags="[]"}
``` {.python}
rf = RandomForestClassifier(random_state = 1,bootstrap=True,criterion='gini',max_depth=15,max_features=10,min_samples_leaf=3,min_samples_split=2,
                           n_estimators=550)
best_clf_rf = rf.fit(X_train_scaled,y_train)
```
:::

::: {.cell .markdown papermill="{\"status\":\"completed\",\"duration\":2.185e-2,\"end_time\":\"2022-10-13T14:19:30.241920\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:30.220070\"}" tags="[]"}
`<font size="4" color="black">`{=html} I performed the same GridSearch
for the SVM and found the following best parameters:

`<font size="4" color="black">`{=html}

    C: 1
     
    gamma: 0.1
     
    kernel: rbf
     
:::

::: {.cell .code execution_count="25" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:30.289095Z\",\"iopub.status.idle\":\"2022-10-13T14:19:30.474239Z\",\"iopub.execute_input\":\"2022-10-13T14:19:30.289542Z\",\"shell.execute_reply\":\"2022-10-13T14:19:30.472957Z\"}" papermill="{\"status\":\"completed\",\"duration\":0.212888,\"end_time\":\"2022-10-13T14:19:30.477291\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:30.264403\"}" tags="[]"}
``` {.python}
svc = SVC(probability = True,C=1.0,kernel="rbf",gamma=0.1)
best_clf_svc = svc.fit(X_train_scaled,y_train)
```
:::

::: {.cell .markdown papermill="{\"status\":\"completed\",\"duration\":2.0648e-2,\"end_time\":\"2022-10-13T14:19:30.520870\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:30.500222\"}" tags="[]"}
`<font size="4" color="black">`{=html} Here we are extracting the
feature importance for the two models. The plan is to take the combined
top10 features of both models to use as our features for the deep
learning.

`<font size="4" color="black">`{=html}
:::

::: {.cell .code execution_count="26" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:30.565823Z\",\"iopub.status.idle\":\"2022-10-13T14:19:41.977313Z\",\"iopub.execute_input\":\"2022-10-13T14:19:30.566224Z\",\"shell.execute_reply\":\"2022-10-13T14:19:41.976228Z\"}" papermill="{\"status\":\"completed\",\"duration\":11.437195,\"end_time\":\"2022-10-13T14:19:41.979704\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:30.542509\"}" tags="[]"}
``` {.python}
perm_importance = permutation_importance(best_clf_rf, X_train_scaled, y_train)
feat_importances_rf = pd.Series(perm_importance.importances_mean,index=X_train_scaled.columns)

feat_importances_rf_plt = feat_importances_rf.nlargest(10).plot(kind='barh')
```

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/11502fcd1e833ae2feff7914cbfb2c61c8f6f6f8.png)
:::
:::

::: {.cell .code execution_count="27" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:42.024340Z\",\"iopub.status.idle\":\"2022-10-13T14:19:45.119890Z\",\"iopub.execute_input\":\"2022-10-13T14:19:42.025052Z\",\"shell.execute_reply\":\"2022-10-13T14:19:45.118706Z\"}" papermill="{\"status\":\"completed\",\"duration\":3.121275,\"end_time\":\"2022-10-13T14:19:45.122452\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:42.001177\"}" tags="[]"}
``` {.python}
perm_importance = permutation_importance(best_clf_svc, X_train_scaled, y_train)
feat_importances_svm = pd.Series(perm_importance.importances_mean,index=X_train_scaled.columns)

feat_importances_svm_plt = feat_importances_svm.nlargest(10).plot(kind='barh')
```

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/e95fbd7b2bb276ec60252e0cc7f79b4a3f7dec69.png)
:::
:::

::: {.cell .code execution_count="28" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:45.167910Z\",\"iopub.status.idle\":\"2022-10-13T14:19:45.180767Z\",\"iopub.execute_input\":\"2022-10-13T14:19:45.168760Z\",\"shell.execute_reply\":\"2022-10-13T14:19:45.179432Z\"}" papermill="{\"status\":\"completed\",\"duration\":3.9199e-2,\"end_time\":\"2022-10-13T14:19:45.183540\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:45.144341\"}" tags="[]"}
``` {.python}
# find the common features for deep learning
a=feat_importances_svm.nlargest(10).index
b=feat_importances_rf.nlargest(10).index
df=pd.DataFrame([a,b]).transpose()#

df = df[0].append(df[1]).drop_duplicates('first')

X_train_DL = X_train_scaled[df]
X_test_DL = X_test_scaled[df]

y_train_DL = y_train

dense_neuron = X_train_DL.shape[1]
```

::: {.output .stream .stderr}
    /opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:6: FutureWarning: In a future version of pandas all arguments of Series.drop_duplicates will be keyword-only
      
:::
:::

::: {.cell .markdown papermill="{\"status\":\"completed\",\"duration\":2.2965e-2,\"end_time\":\"2022-10-13T14:19:45.228228\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:45.205263\"}" tags="[]"}
`<font size="4" color="black">`{=html} I ran the deep learning model
looping through the 8 different optimizers to find the version with the
highest accuracy/lowest loss

```{=html}
<table style="border-collapse: collapse;font-size: 15px; width:800px;">
  <tr>
    <th style="background-color:#D3DBDD;">Optimizer </th>
    <th style="background-color:#D3DBDD;">Loss</th>
    <th style="background-color:#D3DBDD;">Accuracy Percentage</th>
  </tr>
  <tr>
    <td>SGD</td>
    <td>0.125</td>
    <td>83.38%</td>
  </tr>
  <tr>
      <td><b>RMSprop</b> </td>
    <td><b>0.0976</b></td>
    <td><b>87.54%</b></td>
  </tr>
  <tr>
    <td>Adam </td>
    <td>0.108 </td>
    <td>86.083%</td>
  </tr>
  <tr>
    <td>Adadelta </td>
    <td>0.264</td>
    <td>37.59%</td>
  </tr>
  <tr>
    <td>Adagrad </td>
    <td>0.133 </td>
    <td>82.37%</td>
  </tr>
  <tr>
    <td>Adamax</td>
    <td>0.110</td>
    <td>85.29%</td>
  </tr>
  <tr>
    <td>Nadam</td>
    <td>0.106</td>
    <td>86.08%</td>
  </tr>
  <tr>
    <td>Ftrl</td>
    <td>0.249 </td>
    <td>61.61%</td>
  </tr>
</table>
```
`<font size="4" color="black">`{=html} As we can see, RMRprop gave the
best results, so we will use that optimizer moving forward
:::

::: {.cell .code execution_count="29" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:45.273614Z\",\"iopub.status.idle\":\"2022-10-13T14:19:45.283182Z\",\"iopub.execute_input\":\"2022-10-13T14:19:45.274808Z\",\"shell.execute_reply\":\"2022-10-13T14:19:45.281986Z\"}" papermill="{\"status\":\"completed\",\"duration\":3.6151e-2,\"end_time\":\"2022-10-13T14:19:45.286204\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:45.250053\"}" tags="[]"}
``` {.python}
# separating the training data into train/test splits for use in our model fitting
XDL_train,XDL_test,yDL_train,yDL_test=train_test_split(X_train_DL,y_train,test_size=0.2,random_state=1234)
```
:::

::: {.cell .code execution_count="30" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:45.331447Z\",\"iopub.status.idle\":\"2022-10-13T14:19:51.833780Z\",\"iopub.execute_input\":\"2022-10-13T14:19:45.331885Z\",\"shell.execute_reply\":\"2022-10-13T14:19:51.832583Z\"}" papermill="{\"status\":\"completed\",\"duration\":6.529255,\"end_time\":\"2022-10-13T14:19:51.837116\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:45.307861\"}" tags="[]"}
``` {.python}
# here we are defining some parameters to use in our model

from tensorflow import keras
from tensorflow.keras import layers
from sklearn.model_selection import KFold
from tensorflow.keras.wrappers.scikit_learn import KerasClassifier
from tqdm.notebook import tqdm
from sklearn.utils import shuffle
import tensorflow.keras.backend as K

COLS = list(XDL_train.columns) # defining the columns

batch_size=128
epoch = 500
mae = pd.DataFrame
kFold = KFold(n_splits=10,
              shuffle=True) # defining the number of cross-validation kfolds we want to perform

inputs = np.concatenate((XDL_train,
                         XDL_test),
                        axis=0) # combining the test/train data

targets = np.concatenate((yDL_train,
                          yDL_test),
                         axis=0)
```
:::

::: {.cell .markdown papermill="{\"status\":\"completed\",\"duration\":2.1033e-2,\"end_time\":\"2022-10-13T14:19:51.879608\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:51.858575\"}" tags="[]"}
`<font size="4" color="black">`{=html} Brace yourself, this is a wall of
text. I could have subdivided this into several functions but it all
works and runs well. Perhaps I can clean it up a bit another time. But
for now lets consider what this model is achieving:

-   `<font size="3" color="black">`{=html}First we are defining a table
    that will output our mean absolute error scores.

-   `<font size="3" color="black">`{=html}Next we are collecting the
    results into lists that we can use for printing.

-   `<font size="3" color="black">`{=html}The model then enters into an
    outer for loop that will loop over the number of folds that we want
    to run (defined above).

-   `<font size="3" color="black">`{=html}Within this loop we will
    re-define the model on every run, compile the model using our
    predefined standards and fit the model.

-   `<font size="3" color="black">`{=html}Before we fit, we are creating
    several callbacks that can be used during the run:

           1.`<font size="3" color="black">`{=html} A callback that will
    stop the current run if certain amount of progression has passed
    without improvement.

           2.`<font size="3" color="black">`{=html} A callback that
    saves the best weights based on improvements across each epoch.

-   `<font size="3" color="black">`{=html}The data is split manually
    based on the kFolds function defined above. Each iteration of the
    outer loop will use a different subsection of the data for test and
    validation.

-   `<font size="3" color="black">`{=html}After the data are fit to the
    model, we want to extract the feature importance much like we have
    done above.

-   `<font size="3" color="black">`{=html}For this to work first we must
    define a baseline score, here calculated by defining the out of
    function predictions based on all the valid data and then taking the
    absolute mean of that score divided by the valid list.

-   `<font size="3" color="black">`{=html}After this we enter into an
    inner loop which does the same thing for each feature but shuffles
    the column each time.

-   `<font size="3" color="black">`{=html}The last part of the function
    is just dealing with the outputs `</font>`{=html}
:::

::: {.cell .code execution_count="31" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:51.924280Z\",\"iopub.status.idle\":\"2022-10-13T14:19:51.952695Z\",\"iopub.execute_input\":\"2022-10-13T14:19:51.925120Z\",\"shell.execute_reply\":\"2022-10-13T14:19:51.951470Z\"}" papermill="{\"status\":\"completed\",\"duration\":5.4271e-2,\"end_time\":\"2022-10-13T14:19:51.955349\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:51.901078\"}" tags="[]"}
``` {.python}
def DLmodel(inputs,targets,columns,batch_size,epochs,kFold):
    results_table = {}
    acc_per_fold = [] # variable to collect the accuracy for printing and saving
    loss_per_fold = [] # variable to collect the loss for printing and saving
    i = 0
    fold_no = 1
    for fold,(train_idx,test_idx) in enumerate(kFold.split(inputs,targets)):
    
        K.clear_session()
        
        print('-'*15, '>', f'Fold {fold+1}', '<', '-'*15)
        X_train, X_valid = inputs[train_idx], inputs[test_idx]
        y_train, y_valid = targets[train_idx], targets[test_idx]
        checkpoint_filepath = f"folds{fold}.hdf5"
    
        #################################################################
        # creating the keras model
        model = keras.Sequential([
            layers.BatchNormalization(),
            layers.Dense(32,
                         activation = 'relu',
                         input_shape=([dense_neuron])),
            layers.Dropout(0.3),
            layers.BatchNormalization(),
            layers.Dense(32,
                         activation = 'relu'),
            layers.BatchNormalization(),
            layers.Dense(32,
                         activation = 'relu'),
            layers.Dropout(0.3),
            layers.Dense(1,
                         activation = 'sigmoid')
        ])

        model.compile(
            optimizer = 'RMSprop',
            loss = 'mae',
            metrics=['accuracy']
    
        )
        #################################################################
        # Generate a print
        print('------------------------------------------------------------------------')
        print(f'Training for fold {fold_no} ...')
    
        #################################################################
        # create the early stopping and saving functionality
        early_stopping = keras.callbacks.EarlyStopping(
            patience = 100,
            min_delta = 0.001,
            restore_best_weights=True,
        )
        save_best = keras.callbacks.ModelCheckpoint(
            filepath=checkpoint_filepath,
            save_weights_only=False,
            monitor='val_accuracy',
            mode='max',
            verbose=0,
            save_best_only=True)

        # fit the model
        history = model.fit(
            X_train,
            y_train,
            validation_data=(X_valid,
                             y_valid),    
            batch_size=batch_size,
            epochs = epochs,
            callbacks=[early_stopping,
                       save_best],
            verbose = False,
        )
        scores = model.evaluate(X_valid,
                                y_valid,
                                verbose=0)
        print(f'Score for fold {fold_no}: {model.metrics_names[0]} of {scores[0]};{model.metrics_names[1]} of {scores[1]*100}%')
        print(f'optimizer: RMSprop')
        acc_per_fold.append(scores[1]*100)
        loss_per_fold.append(scores[0])   

        #################################################################
        # Increase fold number

        
        print('Calculating feature importance...')
            
        # compute baseline (no shuffle)
        oof_preds = model.predict(X_valid,
                                  verbose=0).squeeze() 
        baseline_mae = np.mean(np.abs(oof_preds-y_valid ))
    
        for col in columns:
            if not col in results_table.keys():
                results_table[col] = []
                results_table['baseline'] = []
       
        results_table['baseline'].append(baseline_mae)
    
        ################################################################# 
        # add col names before loops
    

        # defining a function to take care of the inner loop calculations
        for k in tqdm(range(len(columns))):
            # shuffle feature 
            save_col = X_valid[:,k].copy()
            np.random.shuffle(X_valid[:,k])
            col_name = columns[k]
            # computer oof mae with feature k shuffled
            oof_preds = model.predict(X_valid,
                                        verbose=0).squeeze()

            results_table[col_name].append(np.mean(np.abs(oof_preds-y_valid)))
            X_valid[:,k] = save_col
    
        
    
        #################################################################
        # display feature importance
        
        df = pd.DataFrame.from_dict(results_table)
        df = df.iloc[fold].sort_values(ascending=True)
        plt.figure(figsize=(5,6))
        plt.barh(np.arange(len(columns)+1),
                 df.values)
        plt.yticks(np.arange(len(columns)+1),
                   df.index)
        plt.title(f'K-Fold {fold+1} Feature Importance',
                  size=16)
        plt.ylim((-1,len(columns)+1))
        plt.plot([baseline_mae,
                  baseline_mae],
                 [-1,len(columns)+1],
                 '--', color='red',
                 label=f'Baseline OOF\nMAE={baseline_mae:.3f}')
        plt.xlabel(f'Fold {fold+1} OOF MAE with feature permuted',
                   size=14)
        plt.ylabel('Feature',
                   size=14)
        plt.legend()
        plt.show()
                               
        # SAVE FEATURE IMPORTANCE
        df.to_csv(f'feature_importance_fold_{fold+1}.csv',
                  index=False)
    
        fold_no = fold_no + 1
        i = i+1
    
    #################################################################

    # == Provide average scores ==
    print('------------------------------------------------------------------------')
    print('Score per fold')
    for i in range(0, len(acc_per_fold)):
      print('------------------------------------------------------------------------')
      print(f'> Fold {i+1} - Loss: {loss_per_fold[i]} - Accuracy: {acc_per_fold[i]}%')
    print('------------------------------------------------------------------------')
    print('Average scores for all folds:')
    print(f'> Accuracy: {np.mean(acc_per_fold)} (+- {np.std(acc_per_fold)})')
    print(f'> Loss: {np.mean(loss_per_fold)}')
    print('------------------------------------------------------------------------')

    history_df = pd.DataFrame(history.history)
    history_df.loc[:, ['loss', 'val_loss','accuracy','val_accuracy']].plot();
    print("Minimum validation loss: {}".format(history_df['val_loss'].min()))
    pd.DataFrame.from_dict(results_table)
    
    return history, results_table, save_best
```
:::

::: {.cell .code execution_count="32" execution="{\"iopub.status.busy\":\"2022-10-13T14:19:52.000657Z\",\"iopub.status.idle\":\"2022-10-13T14:22:37.769658Z\",\"iopub.execute_input\":\"2022-10-13T14:19:52.001110Z\",\"shell.execute_reply\":\"2022-10-13T14:22:37.768520Z\"}" papermill="{\"status\":\"completed\",\"duration\":165.795048,\"end_time\":\"2022-10-13T14:22:37.771943\",\"exception\":false,\"start_time\":\"2022-10-13T14:19:51.976895\"}" tags="[]"}
``` {.python}
history,results_table, save_best = DLmodel(inputs,targets,COLS,batch_size,epoch,kFold)
```

::: {.output .stream .stdout}
    --------------- > Fold 1 < ---------------
    ------------------------------------------------------------------------
    Training for fold 1 ...
:::

::: {.output .stream .stderr}
    2022-10-13 14:19:52.060956: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
    2022-10-13 14:19:52.182187: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
:::

::: {.output .stream .stdout}
    Score for fold 1: loss of 0.1486242264509201;accuracy of 85.5555534362793%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"aa0fc145b54e46df99877646ff1e0563"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/2aae1073b8d5b9215ac5f7c15dd1b8f053363110.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 2 < ---------------
    ------------------------------------------------------------------------
    Training for fold 2 ...
    Score for fold 2: loss of 0.15655222535133362;accuracy of 85.39325594902039%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"40576a5dbf8b4c3f9487f2717b61cc9f"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/f3ee1920658d1856d789479b6c83569705842a4c.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 3 < ---------------
    ------------------------------------------------------------------------
    Training for fold 3 ...
    Score for fold 3: loss of 0.2166995406150818;accuracy of 78.65168452262878%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"2e701e3c8ea14d5083e75414c53c9b4f"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/cd21e336c0c980a5947ef3ed72f36bf0dfc1b30c.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 4 < ---------------
    ------------------------------------------------------------------------
    Training for fold 4 ...
    Score for fold 4: loss of 0.09792616963386536;accuracy of 91.01123809814453%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"8c0835b1ac8a41929e2dd109cf607530"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/64fe357bc62d05cf8aa04db6a8a219c989f5ded4.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 5 < ---------------
    ------------------------------------------------------------------------
    Training for fold 5 ...
    Score for fold 5: loss of 0.173434317111969;accuracy of 83.14606547355652%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"3525fa1b84da4080828f5248d925c1d2"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/27acb30605de5cc92bb004e986d31434bfe871dc.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 6 < ---------------
    ------------------------------------------------------------------------
    Training for fold 6 ...
    Score for fold 6: loss of 0.13285966217517853;accuracy of 87.64045238494873%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"14befd37e6864371893bc425249e04d3"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/1108fccee60f42e8e36dcebcfb5cab6055884101.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 7 < ---------------
    ------------------------------------------------------------------------
    Training for fold 7 ...
    Score for fold 7: loss of 0.11041408777236938;accuracy of 88.76404762268066%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"d8c079c4cf6145c7b16b8fdc6df03996"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/13b1c7f2d5f03a14f3443338c0dc4e099ad9fefb.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 8 < ---------------
    ------------------------------------------------------------------------
    Training for fold 8 ...
    Score for fold 8: loss of 0.14105932414531708;accuracy of 86.51685118675232%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"7e34855d620b455da8d62ec7cdba7a96"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/581264665b8c6110c7bd7ef20b93da8c9423c5f6.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 9 < ---------------
    ------------------------------------------------------------------------
    Training for fold 9 ...
    Score for fold 9: loss of 0.2530847489833832;accuracy of 74.15730357170105%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"8600065105424566bba038d79dc53e7a"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/6fd267707bc0dba59414f5febea65741f9c50ecb.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 10 < ---------------
    ------------------------------------------------------------------------
    Training for fold 10 ...
    Score for fold 10: loss of 0.1427287459373474;accuracy of 86.51685118675232%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"0352b219e6be4a84812628abc1d1d8d8"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/205a78a59a87feb20d4b6bbec345c461dd3ca0fa.png)
:::

::: {.output .stream .stdout}
    ------------------------------------------------------------------------
    Score per fold
    ------------------------------------------------------------------------
    > Fold 1 - Loss: 0.1486242264509201 - Accuracy: 85.5555534362793%
    ------------------------------------------------------------------------
    > Fold 2 - Loss: 0.15655222535133362 - Accuracy: 85.39325594902039%
    ------------------------------------------------------------------------
    > Fold 3 - Loss: 0.2166995406150818 - Accuracy: 78.65168452262878%
    ------------------------------------------------------------------------
    > Fold 4 - Loss: 0.09792616963386536 - Accuracy: 91.01123809814453%
    ------------------------------------------------------------------------
    > Fold 5 - Loss: 0.173434317111969 - Accuracy: 83.14606547355652%
    ------------------------------------------------------------------------
    > Fold 6 - Loss: 0.13285966217517853 - Accuracy: 87.64045238494873%
    ------------------------------------------------------------------------
    > Fold 7 - Loss: 0.11041408777236938 - Accuracy: 88.76404762268066%
    ------------------------------------------------------------------------
    > Fold 8 - Loss: 0.14105932414531708 - Accuracy: 86.51685118675232%
    ------------------------------------------------------------------------
    > Fold 9 - Loss: 0.2530847489833832 - Accuracy: 74.15730357170105%
    ------------------------------------------------------------------------
    > Fold 10 - Loss: 0.1427287459373474 - Accuracy: 86.51685118675232%
    ------------------------------------------------------------------------
    Average scores for all folds:
    > Accuracy: 84.73533034324646 (+- 4.721670677586862)
    > Loss: 0.15733830481767655
    ------------------------------------------------------------------------
    Minimum validation loss: 0.1427287608385086
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/e88a4adb39700b2d9a73f13f8509c9703f1760af.png)
:::
:::

::: {.cell .markdown papermill="{\"status\":\"completed\",\"duration\":2.9309e-2,\"end_time\":\"2022-10-13T14:22:37.830820\",\"exception\":false,\"start_time\":\"2022-10-13T14:22:37.801511\"}" tags="[]"}
`<font size="4" color="black">`{=html} As we can see from the output,
the model is performing pretty well (between 80-90% accuracy). The plan
now, which is totally not necessary and is purely for exploration at
this point. Is to take the overall best features across all of the folds
and take the best 5 and apply it to one more run. Just to see if using
less features that are the most informative is able to squeeze out a
little more accuracy. Obviously we want to be careful as well to keep an
eye on our loss/val_loss scores to make sure we aren\'t
overfitting/underfitting.
:::

::: {.cell .code execution_count="33" execution="{\"iopub.status.busy\":\"2022-10-13T14:22:37.889822Z\",\"iopub.status.idle\":\"2022-10-13T14:22:38.167898Z\",\"iopub.execute_input\":\"2022-10-13T14:22:37.890261Z\",\"shell.execute_reply\":\"2022-10-13T14:22:38.166606Z\"}" papermill="{\"status\":\"completed\",\"duration\":0.311186,\"end_time\":\"2022-10-13T14:22:38.170948\",\"exception\":false,\"start_time\":\"2022-10-13T14:22:37.859762\"}" tags="[]"}
``` {.python}
from matplotlib.pyplot import figure

param_data = pd.DataFrame.from_dict(results_table)
mean_param_data = {}
for i in param_data:
    mean_param_data[i] = []
    mean_param_data[i].append(param_data[i].mean())
figure(figsize=(16, 12), dpi=80)
plt.scatter(*zip(*sorted(mean_param_data.items()))) 
plt.show()
mean_param_data = pd.Series(mean_param_data)
```

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/0518421a98388281d184835391b5d8bcd700fa29.png)
:::
:::

::: {.cell .markdown papermill="{\"status\":\"completed\",\"duration\":2.883e-2,\"end_time\":\"2022-10-13T14:22:38.229407\",\"exception\":false,\"start_time\":\"2022-10-13T14:22:38.200577\"}" tags="[]"}
`<font size="3" color="black">`{=html} Here is a simple scatter plot
detailing the average feature importance across all the folds. We are
going to take the best 5 and use it for the final model.
:::

::: {.cell .code execution_count="34" execution="{\"iopub.status.busy\":\"2022-10-13T14:22:38.289409Z\",\"iopub.status.idle\":\"2022-10-13T14:22:38.298273Z\",\"iopub.execute_input\":\"2022-10-13T14:22:38.290169Z\",\"shell.execute_reply\":\"2022-10-13T14:22:38.297260Z\"}" papermill="{\"status\":\"completed\",\"duration\":4.2243e-2,\"end_time\":\"2022-10-13T14:22:38.300761\",\"exception\":false,\"start_time\":\"2022-10-13T14:22:38.258518\"}" tags="[]"}
``` {.python}
top5_params = mean_param_data.sort_values(ascending = False)[0:5]
top5COLS = list(top5_params.index)

inputs = np.concatenate((XDL_train[top5COLS],
                         XDL_test[top5COLS]),
                        axis=0) # combining the test/train data

targets = np.concatenate((yDL_train,
                          yDL_test),
                         axis=0)
```
:::

::: {.cell .code execution_count="35" execution="{\"iopub.status.busy\":\"2022-10-13T14:22:38.362282Z\",\"iopub.status.idle\":\"2022-10-13T14:25:43.753038Z\",\"iopub.execute_input\":\"2022-10-13T14:22:38.362933Z\",\"shell.execute_reply\":\"2022-10-13T14:25:43.751707Z\"}" papermill="{\"status\":\"completed\",\"duration\":185.424934,\"end_time\":\"2022-10-13T14:25:43.755678\",\"exception\":false,\"start_time\":\"2022-10-13T14:22:38.330744\"}" tags="[]"}
``` {.python}
best_params,results_table_params, save_best_params = DLmodel(inputs,targets,top5COLS,batch_size,epoch,kFold)
```

::: {.output .stream .stdout}
    --------------- > Fold 1 < ---------------
    ------------------------------------------------------------------------
    Training for fold 1 ...
    Score for fold 1: loss of 0.1779356151819229;accuracy of 82.22222328186035%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"7e8b657936f34d10b40aa70443ab7e4b"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/ef82b29ea9e6e79d12fe455939db42b86d515b56.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 2 < ---------------
    ------------------------------------------------------------------------
    Training for fold 2 ...
    Score for fold 2: loss of 0.18038129806518555;accuracy of 82.02247023582458%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"a0ac7771fb494a709ef7c46a02f5a753"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/38908d0733c6041e8406910604af2db42a38cda4.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 3 < ---------------
    ------------------------------------------------------------------------
    Training for fold 3 ...
    Score for fold 3: loss of 0.07055552303791046;accuracy of 93.2584285736084%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"d52396c2bf69463785df78d3e6dbdeef"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/ecc77f686211ad6022677c0a5443b872046cf0a9.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 4 < ---------------
    ------------------------------------------------------------------------
    Training for fold 4 ...
    Score for fold 4: loss of 0.20372572541236877;accuracy of 79.77527976036072%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"52b93245e1fe40159b09cc452962b4c2"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/5e9edb4652dc8ecd8346cc5e46b505cc5c42e4b9.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 5 < ---------------
    ------------------------------------------------------------------------
    Training for fold 5 ...
    Score for fold 5: loss of 0.1693388819694519;accuracy of 83.14606547355652%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"2334b3b4b7594934aa3bf3f576d08e40"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/d6ebae9f71ce39da71e9c7b5d1ccddbd70824a23.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 6 < ---------------
    ------------------------------------------------------------------------
    Training for fold 6 ...
    Score for fold 6: loss of 0.20285668969154358;accuracy of 79.77527976036072%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"a9965038167d4c4c835dcde09dfb85f8"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/c17ab3bba5158ef4747f56dd9248bcf091623ba3.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 7 < ---------------
    ------------------------------------------------------------------------
    Training for fold 7 ...
    Score for fold 7: loss of 0.1771462857723236;accuracy of 82.02247023582458%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"9775e1a05a1e41ebb1a265fbedc5d593"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/ad8e81c5409721565ae415c52d10c6f921af5054.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 8 < ---------------
    ------------------------------------------------------------------------
    Training for fold 8 ...
    Score for fold 8: loss of 0.11299433559179306;accuracy of 88.76404762268066%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"07b87e2a9c414b6389b0e7662a2c791f"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/f80c231e2559a068bde26f317d1f8980e88dc9ee.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 9 < ---------------
    ------------------------------------------------------------------------
    Training for fold 9 ...
    Score for fold 9: loss of 0.13493190705776215;accuracy of 86.51685118675232%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"e01689e265544115b229f36ddb25b663"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/e9ddf70c2f0ecf47e0a114e69eeda07099aaf823.png)
:::

::: {.output .stream .stdout}
    --------------- > Fold 10 < ---------------
    ------------------------------------------------------------------------
    Training for fold 10 ...
    Score for fold 10: loss of 0.22170962393283844;accuracy of 77.52808928489685%
    optimizer: RMSprop
    Calculating feature importance...
:::

::: {.output .display_data}
``` {.json}
{"version_major":2,"version_minor":0,"model_id":"06b9725bcd5844539bf28f735e65efb4"}
```
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/b00c4ebd0214aad5a639dcc236f2f8b873fdaa2c.png)
:::

::: {.output .stream .stdout}
    ------------------------------------------------------------------------
    Score per fold
    ------------------------------------------------------------------------
    > Fold 1 - Loss: 0.1779356151819229 - Accuracy: 82.22222328186035%
    ------------------------------------------------------------------------
    > Fold 2 - Loss: 0.18038129806518555 - Accuracy: 82.02247023582458%
    ------------------------------------------------------------------------
    > Fold 3 - Loss: 0.07055552303791046 - Accuracy: 93.2584285736084%
    ------------------------------------------------------------------------
    > Fold 4 - Loss: 0.20372572541236877 - Accuracy: 79.77527976036072%
    ------------------------------------------------------------------------
    > Fold 5 - Loss: 0.1693388819694519 - Accuracy: 83.14606547355652%
    ------------------------------------------------------------------------
    > Fold 6 - Loss: 0.20285668969154358 - Accuracy: 79.77527976036072%
    ------------------------------------------------------------------------
    > Fold 7 - Loss: 0.1771462857723236 - Accuracy: 82.02247023582458%
    ------------------------------------------------------------------------
    > Fold 8 - Loss: 0.11299433559179306 - Accuracy: 88.76404762268066%
    ------------------------------------------------------------------------
    > Fold 9 - Loss: 0.13493190705776215 - Accuracy: 86.51685118675232%
    ------------------------------------------------------------------------
    > Fold 10 - Loss: 0.22170962393283844 - Accuracy: 77.52808928489685%
    ------------------------------------------------------------------------
    Average scores for all folds:
    > Accuracy: 83.50312054157257 (+- 4.489692528671384)
    > Loss: 0.16515758857131005
    ------------------------------------------------------------------------
    Minimum validation loss: 0.22170962393283844
:::

::: {.output .display_data}
![](vertopal_a321c76ad9204f40b16c3b1b7fe466bd/e11984fcc485c4cc4a04a856571f2454149a78b7.png)
:::
:::

::: {.cell .markdown papermill="{\"status\":\"completed\",\"duration\":3.7672e-2,\"end_time\":\"2022-10-13T14:25:43.830285\",\"exception\":false,\"start_time\":\"2022-10-13T14:25:43.792613\"}" tags="[]"}
`<font size="3" color="black">`{=html} Accuracy seems to be staying put,
still around 80-90%. Which is interesting in of itself. Even without the
other variables we are still able to predict survival likelihood to a
very high percentage.
:::

::: {.cell .code execution_count="36" execution="{\"iopub.status.busy\":\"2022-10-13T14:25:43.908120Z\",\"iopub.status.idle\":\"2022-10-13T14:25:45.520023Z\",\"iopub.execute_input\":\"2022-10-13T14:25:43.909096Z\",\"shell.execute_reply\":\"2022-10-13T14:25:45.518942Z\"}" papermill="{\"status\":\"completed\",\"duration\":1.654609,\"end_time\":\"2022-10-13T14:25:45.522776\",\"exception\":false,\"start_time\":\"2022-10-13T14:25:43.868167\"}" tags="[]"}
``` {.python}
Xfinal_train = X_train_DL[top5_params.index] # creating the testing set with the finalised features
Xfinal_test = X_test_DL[top5_params.index]
best_final = {}
for i in range(kFold.n_splits): 
    # this loop extracts the accuracy and loss from each of our folds evaluated on the whole.
    # training set rather than using out of sample kFolds. We will then save this into a library and find the very best weights to use.
    # this isn't strictly best practice, but like I said earlier, this is more just for exploration and seeing what we can squeeze out.
    save_best_params.model.load_weights(f'folds{i}.hdf5')
    best_final[f'folds{i}.hdf5'] = []
    best_final[f'folds{i}.hdf5'].append(save_best_params.model.evaluate(Xfinal_train,y_train_DL,verbose=True)[1])
```

::: {.output .stream .stdout}
    28/28 [==============================] - 0s 2ms/step - loss: 0.1806 - accuracy: 0.8305
    28/28 [==============================] - 0s 3ms/step - loss: 0.1664 - accuracy: 0.8350
    28/28 [==============================] - 0s 2ms/step - loss: 0.1645 - accuracy: 0.8361
    28/28 [==============================] - 0s 2ms/step - loss: 0.3249 - accuracy: 0.8092
    28/28 [==============================] - 0s 2ms/step - loss: 0.3400 - accuracy: 0.7834
    28/28 [==============================] - 0s 2ms/step - loss: 0.1712 - accuracy: 0.8316
    28/28 [==============================] - 0s 2ms/step - loss: 0.3995 - accuracy: 0.7643
    28/28 [==============================] - 0s 2ms/step - loss: 0.1710 - accuracy: 0.8305
    28/28 [==============================] - 0s 2ms/step - loss: 0.1659 - accuracy: 0.8339
    28/28 [==============================] - 0s 2ms/step - loss: 0.1805 - accuracy: 0.8260
:::
:::

::: {.cell .code execution="{\"iopub.status.busy\":\"2022-10-13T13:14:54.535537Z\",\"shell.execute_reply.started\":\"2022-10-13T13:14:54.536079Z\",\"iopub.status.idle\":\"2022-10-13T13:14:54.573679Z\",\"iopub.execute_input\":\"2022-10-13T13:14:54.536123Z\",\"shell.execute_reply\":\"2022-10-13T13:14:54.571678Z\"}" papermill="{\"status\":\"completed\",\"duration\":3.9624e-2,\"end_time\":\"2022-10-13T14:25:45.602665\",\"exception\":false,\"start_time\":\"2022-10-13T14:25:45.563041\"}" tags="[]"}
``` {.python}
```
:::

::: {.cell .code execution_count="37" execution="{\"iopub.status.busy\":\"2022-10-13T14:25:45.683866Z\",\"iopub.status.idle\":\"2022-10-13T14:25:45.823488Z\",\"iopub.execute_input\":\"2022-10-13T14:25:45.684991Z\",\"shell.execute_reply\":\"2022-10-13T14:25:45.822099Z\"}" papermill="{\"status\":\"completed\",\"duration\":0.183318,\"end_time\":\"2022-10-13T14:25:45.825911\",\"exception\":false,\"start_time\":\"2022-10-13T14:25:45.642593\"}" tags="[]"}
``` {.python}
save_best_params.model.load_weights(max(best_final))
save_best_params.model.evaluate(Xfinal_train,y_train_DL,verbose=True)
```

::: {.output .stream .stdout}
    28/28 [==============================] - 0s 2ms/step - loss: 0.1805 - accuracy: 0.8260
:::

::: {.output .execute_result execution_count="37"}
    [0.1804504543542862, 0.8260381817817688]
:::
:::

::: {.cell .markdown papermill="{\"status\":\"completed\",\"duration\":4.1026e-2,\"end_time\":\"2022-10-13T14:25:45.907526\",\"exception\":false,\"start_time\":\"2022-10-13T14:25:45.866500\"}" tags="[]"}
## `<p style="background-color:#90EE90;color:black;font-size:30px;text-align:center;border-radius:12px 10px;border:2px;">`{=html} 4. Model Prediction of Survival `</p>`{=html} {#-4-model-prediction-of-survival-}

`<font size="3" color="black">`{=html} So here we are at the moment of
truth! We are going to use the testing data with our modified feature
inputs to predict survival and submit to the competition!
:::

::: {.cell .code execution_count="38" execution="{\"iopub.status.busy\":\"2022-10-13T14:25:45.992367Z\",\"iopub.status.idle\":\"2022-10-13T14:25:46.203877Z\",\"iopub.execute_input\":\"2022-10-13T14:25:45.993307Z\",\"shell.execute_reply\":\"2022-10-13T14:25:46.202364Z\"}" papermill="{\"status\":\"completed\",\"duration\":0.257422,\"end_time\":\"2022-10-13T14:25:46.206459\",\"exception\":false,\"start_time\":\"2022-10-13T14:25:45.949037\"}" tags="[]"}
``` {.python}
from keras import models

print('Generate a prediction')
prediction = np.round(save_best_params.model.predict(Xfinal_test)).astype(int)

print('prediction shape:',prediction.shape)
```

::: {.output .stream .stdout}
    Generate a prediction
    prediction shape: (418, 1)
:::
:::

::: {.cell .code execution_count="39" execution="{\"iopub.status.busy\":\"2022-10-13T14:25:46.289498Z\",\"iopub.status.idle\":\"2022-10-13T14:25:46.296126Z\",\"iopub.execute_input\":\"2022-10-13T14:25:46.290308Z\",\"shell.execute_reply\":\"2022-10-13T14:25:46.295301Z\"}" papermill="{\"status\":\"completed\",\"duration\":5.1178e-2,\"end_time\":\"2022-10-13T14:25:46.298284\",\"exception\":false,\"start_time\":\"2022-10-13T14:25:46.247106\"}" tags="[]"}
``` {.python}
final_data = {'PassengerId':test_data.PassengerId,
             'Survived':prediction.transpose(1,0)[0,:]}

submission = pd.DataFrame(final_data)
```
:::

::: {.cell .code execution_count="40" execution="{\"iopub.status.busy\":\"2022-10-13T14:25:46.381476Z\",\"iopub.status.idle\":\"2022-10-13T14:25:46.389146Z\",\"iopub.execute_input\":\"2022-10-13T14:25:46.382852Z\",\"shell.execute_reply\":\"2022-10-13T14:25:46.388059Z\"}" papermill="{\"status\":\"completed\",\"duration\":5.2759e-2,\"end_time\":\"2022-10-13T14:25:46.391343\",\"exception\":false,\"start_time\":\"2022-10-13T14:25:46.338584\"}" tags="[]"}
``` {.python}
submission.to_csv('submission.csv',index=False)
```
:::
